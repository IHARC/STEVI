(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,50320,e=>{"use strict";var a=e.i(43476),t=e.i(71645),i=e.i(81140),l=e.i(30030),s=e.i(42727),r=e.i(96626),n=e.i(48425),o=e.i(86318),d=e.i(69340),c=e.i(10772),m="Tabs",[u,x]=(0,l.createContextScope)(m,[s.createRovingFocusGroupScope]),h=(0,s.createRovingFocusGroupScope)(),[p,j]=u(m),g=t.forwardRef((e,t)=>{let{__scopeTabs:i,value:l,onValueChange:s,defaultValue:r,orientation:u="horizontal",dir:x,activationMode:h="automatic",...j}=e,g=(0,o.useDirection)(x),[b,f]=(0,d.useControllableState)({prop:l,onChange:s,defaultProp:r??"",caller:m});return(0,a.jsx)(p,{scope:i,baseId:(0,c.useId)(),value:b,onValueChange:f,orientation:u,dir:g,activationMode:h,children:(0,a.jsx)(n.Primitive.div,{dir:g,"data-orientation":u,...j,ref:t})})});g.displayName=m;var b="TabsList",f=t.forwardRef((e,t)=>{let{__scopeTabs:i,loop:l=!0,...r}=e,o=j(b,i),d=h(i);return(0,a.jsx)(s.Root,{asChild:!0,...d,orientation:o.orientation,dir:o.dir,loop:l,children:(0,a.jsx)(n.Primitive.div,{role:"tablist","aria-orientation":o.orientation,...r,ref:t})})});f.displayName=b;var v="TabsTrigger",y=t.forwardRef((e,t)=>{let{__scopeTabs:l,value:r,disabled:o=!1,...d}=e,c=j(v,l),m=h(l),u=S(c.baseId,r),x=C(c.baseId,r),p=r===c.value;return(0,a.jsx)(s.Item,{asChild:!0,...m,focusable:!o,active:p,children:(0,a.jsx)(n.Primitive.button,{type:"button",role:"tab","aria-selected":p,"aria-controls":x,"data-state":p?"active":"inactive","data-disabled":o?"":void 0,disabled:o,id:u,...d,ref:t,onMouseDown:(0,i.composeEventHandlers)(e.onMouseDown,e=>{o||0!==e.button||!1!==e.ctrlKey?e.preventDefault():c.onValueChange(r)}),onKeyDown:(0,i.composeEventHandlers)(e.onKeyDown,e=>{[" ","Enter"].includes(e.key)&&c.onValueChange(r)}),onFocus:(0,i.composeEventHandlers)(e.onFocus,()=>{let e="manual"!==c.activationMode;p||o||!e||c.onValueChange(r)})})})});y.displayName=v;var N="TabsContent",T=t.forwardRef((e,i)=>{let{__scopeTabs:l,value:s,forceMount:o,children:d,...c}=e,m=j(N,l),u=S(m.baseId,s),x=C(m.baseId,s),h=s===m.value,p=t.useRef(h);return t.useEffect(()=>{let e=requestAnimationFrame(()=>p.current=!1);return()=>cancelAnimationFrame(e)},[]),(0,a.jsx)(r.Presence,{present:o||h,children:({present:t})=>(0,a.jsx)(n.Primitive.div,{"data-state":h?"active":"inactive","data-orientation":m.orientation,role:"tabpanel","aria-labelledby":u,hidden:!t,id:x,tabIndex:0,...c,ref:i,style:{...e.style,animationDuration:p.current?"0s":void 0},children:t&&d})})});function S(e,a){return`${e}-trigger-${a}`}function C(e,a){return`${e}-content-${a}`}T.displayName=N;var _=e.i(75157);let w=t.forwardRef(({className:e,...t},i)=>(0,a.jsx)(f,{ref:i,className:(0,_.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-space-2xs text-muted-foreground",e),...t}));w.displayName=f.displayName;let I=t.forwardRef(({className:e,...t},i)=>(0,a.jsx)(y,{ref:i,className:(0,_.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-space-sm py-space-xs text-body-md font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...t}));I.displayName=y.displayName;let D=t.forwardRef(({className:e,...t},i)=>(0,a.jsx)(T,{ref:i,className:(0,_.cn)("mt-space-xs ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));D.displayName=T.displayName;var L=e.i(15288),R=e.i(84774);function k({dashboard:e}){return(0,a.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 xl:grid-cols-4",children:[(0,a.jsx)(H,{label:"Items tracked",value:e.summary.totalItems.toLocaleString()}),(0,a.jsx)(H,{label:"Active items",value:e.summary.activeItems.toLocaleString()}),(0,a.jsx)(H,{label:"Low stock alerts",value:e.summary.lowStockCount.toLocaleString(),accent:!0}),(0,a.jsx)(H,{label:"Units on hand",value:e.summary.totalOnHand.toLocaleString()})]}),(0,a.jsxs)("div",{className:"grid gap-6 lg:grid-cols-2",children:[(0,a.jsxs)(L.Card,{className:"h-full",children:[(0,a.jsx)(L.CardHeader,{children:(0,a.jsx)(L.CardTitle,{className:"text-body-lg font-semibold",children:"Low stock items"})}),(0,a.jsx)(L.CardContent,{className:"px-0",children:0===e.lowStockItems.length?(0,a.jsx)(A,{message:"All items are currently above their minimum thresholds."}):(0,a.jsxs)(R.Table,{children:[(0,a.jsx)(R.TableHeader,{children:(0,a.jsxs)(R.TableRow,{children:[(0,a.jsx)(R.TableHead,{children:"Item"}),(0,a.jsx)(R.TableHead,{children:"Category"}),(0,a.jsx)(R.TableHead,{className:"text-right",children:"On hand"}),(0,a.jsx)(R.TableHead,{className:"text-right",children:"Threshold"})]})}),(0,a.jsx)(R.TableBody,{children:e.lowStockItems.slice(0,8).map(e=>(0,a.jsxs)(R.TableRow,{children:[(0,a.jsx)(R.TableCell,{className:"font-medium",children:e.name}),(0,a.jsx)(R.TableCell,{children:e.category??"Uncategorised"}),(0,a.jsx)(R.TableCell,{className:"text-right",children:e.onHandQuantity.toLocaleString()}),(0,a.jsx)(R.TableCell,{className:"text-right",children:null===e.minimumThreshold?"—":e.minimumThreshold.toLocaleString()})]},e.id))})]})})]}),(0,a.jsxs)(L.Card,{className:"h-full",children:[(0,a.jsx)(L.CardHeader,{children:(0,a.jsx)(L.CardTitle,{className:"text-body-lg font-semibold",children:"Expiring soon"})}),(0,a.jsx)(L.CardContent,{className:"px-0",children:0===e.expiringItems.length?(0,a.jsx)(A,{message:"No batches are approaching their expiry window."}):(0,a.jsxs)(R.Table,{children:[(0,a.jsx)(R.TableHeader,{children:(0,a.jsxs)(R.TableRow,{children:[(0,a.jsx)(R.TableHead,{children:"Item"}),(0,a.jsx)(R.TableHead,{children:"Lot"}),(0,a.jsx)(R.TableHead,{children:"Location"}),(0,a.jsx)(R.TableHead,{className:"text-right",children:"Days"})]})}),(0,a.jsx)(R.TableBody,{children:e.expiringItems.slice(0,8).map(e=>(0,a.jsxs)(R.TableRow,{children:[(0,a.jsx)(R.TableCell,{className:"font-medium",children:e.itemName}),(0,a.jsx)(R.TableCell,{children:e.lotNumber??"—"}),(0,a.jsx)(R.TableCell,{children:e.locationName??"—"}),(0,a.jsx)(R.TableCell,{className:"text-right",children:null===e.daysUntilExpiry?"—":e.daysUntilExpiry.toLocaleString()})]},e.id))})]})})]})]}),(0,a.jsxs)(L.Card,{children:[(0,a.jsx)(L.CardHeader,{children:(0,a.jsx)(L.CardTitle,{className:"text-body-lg font-semibold",children:"Recent receipts"})}),(0,a.jsx)(L.CardContent,{className:"px-0",children:0===e.recentReceipts.length?(0,a.jsx)(A,{message:"No stock receipts recorded in the last few days."}):(0,a.jsxs)(R.Table,{children:[(0,a.jsx)(R.TableHeader,{children:(0,a.jsxs)(R.TableRow,{children:[(0,a.jsx)(R.TableHead,{children:"Item"}),(0,a.jsx)(R.TableHead,{children:"Location"}),(0,a.jsx)(R.TableHead,{children:"Source"}),(0,a.jsx)(R.TableHead,{className:"text-right",children:"Quantity"}),(0,a.jsx)(R.TableHead,{className:"text-right",children:"Unit cost"}),(0,a.jsx)(R.TableHead,{className:"text-right",children:"Received"})]})}),(0,a.jsx)(R.TableBody,{children:e.recentReceipts.slice(0,10).map(e=>(0,a.jsxs)(R.TableRow,{children:[(0,a.jsx)(R.TableCell,{className:"font-medium",children:e.itemName}),(0,a.jsx)(R.TableCell,{children:e.locationName??"—"}),(0,a.jsx)(R.TableCell,{children:e.providerOrgName??e.refType??"—"}),(0,a.jsx)(R.TableCell,{className:"text-right",children:e.qty.toLocaleString()}),(0,a.jsx)(R.TableCell,{className:"text-right",children:null===e.unitCost?"—":`$${e.unitCost.toFixed(2)}`}),(0,a.jsx)(R.TableCell,{className:"text-right",children:new Date(e.createdAt).toLocaleDateString()})]},e.id))})]})})]})]})}function H({label:e,value:t,accent:i=!1}){return(0,a.jsxs)(L.Card,{className:i?"border-destructive text-destructive-foreground state-layer-color-error state-layer-hover":"",children:[(0,a.jsx)(L.CardHeader,{children:(0,a.jsx)(L.CardTitle,{className:"text-label-sm font-medium uppercase text-muted-foreground",children:e})}),(0,a.jsx)(L.CardContent,{children:(0,a.jsx)("p",{className:"text-headline-sm font-semibold text-on-surface",children:t})})]})}function A({message:e}){return(0,a.jsx)("div",{className:"flex flex-col items-center justify-center gap-2 p-6 text-center text-body-md text-muted-foreground",children:(0,a.jsx)("p",{children:e})})}var O=e.i(18566),F=e.i(19455),P=e.i(76639),B=e.i(93479),z=e.i(10204),V=e.i(24687),U=e.i(22140),q=e.i(57428),M=e.i(67489),E=e.i(95187),Q=(0,E.createServerReference)("40fb42223fbaabe80e63bff0a00e0c25fc6ca0c331",E.callServer,void 0,E.findSourceMapURL,"adjustInventoryStockAction"),J=(0,E.createServerReference)("40108f8f43fea9ee4608a53636c7e5b4320d353870",E.callServer,void 0,E.findSourceMapURL,"bulkReceiveInventoryStockAction"),$=(0,E.createServerReference)("400bce6c909697364ba29c68866355de13b09a5677",E.callServer,void 0,E.findSourceMapURL,"createInventoryItemAction"),K=(0,E.createServerReference)("40a3769bbe61042790510d7f50d8ece8a924cd4c39",E.callServer,void 0,E.findSourceMapURL,"deleteInventoryItemAction"),W=(0,E.createServerReference)("40851b3784f78e9ef426e0d09453fef736e8732c6a",E.callServer,void 0,E.findSourceMapURL,"receiveInventoryStockAction"),G=(0,E.createServerReference)("40ffa48111ad0c4a3013e10d2da655d8e2d303b4e1",E.callServer,void 0,E.findSourceMapURL,"toggleInventoryItemStatusAction"),X=(0,E.createServerReference)("400b464e5b0991def1b3b2300bc775c284e2b96d8f",E.callServer,void 0,E.findSourceMapURL,"transferInventoryStockAction"),Y=(0,E.createServerReference)("401df522679bb5cd394bde463e79e3f995ce6a5efc",E.callServer,void 0,E.findSourceMapURL,"updateInventoryItemAction");let Z=new Date().toISOString().slice(0,10);function ee({items:e,locations:i,organizations:l,categories:s,actorProfileId:r}){let n=(0,O.useRouter)(),{toast:o}=(0,U.useToast)(),[d,c]=(0,t.useState)(!1),[m,u]=(0,t.useState)(null),[x,h]=(0,t.useState)(null),[p,j]=(0,t.useState)(null),[g,b]=(0,t.useState)(null),[f,v]=(0,t.useState)(!1),[y,N]=(0,t.useTransition)(),T=(0,t.useMemo)(()=>Array.from(new Set(s)).sort((e,a)=>e.localeCompare(a)),[s]),S=(0,t.useMemo)(()=>l.filter(e=>e.isActive),[l]),C=(e,a,t)=>{e.success?(t&&t(),o({title:"Inventory updated",description:a}),N(()=>n.refresh())):o({variant:"destructive",title:"Inventory error",description:e.error??"Action failed."})},_=async e=>{e.set("actor_profile_id",r),C(await $(e),"Item created successfully.",()=>c(!1))},w=async e=>{e.set("actor_profile_id",r),C(await Y(e),"Item updated.",()=>u(null))},I=async e=>{e.set("actor_profile_id",r),C(await W(e),"Stock received.",()=>h(null))},D=async e=>{e.set("actor_profile_id",r),C(await X(e),"Stock transferred.",()=>j(null))},k=async e=>{e.set("actor_profile_id",r),C(await Q(e),"Adjustment applied.",()=>b(null))},H=async(e,a)=>{let t=new FormData;t.set("actor_profile_id",r),t.set("item_id",e.id),t.set("active",String(a)),C(await G(t),a?"Item activated.":"Item deactivated.")},A=async e=>{let a=new FormData;a.set("actor_profile_id",r),a.set("item_id",e.id),C(await K(a),"Item deleted.")},B=async e=>{let a;e.set("actor_profile_id",r);let t=e.get("items_json");if("string"!=typeof t)return void o({title:"Bulk receipt error",variant:"destructive",description:"Bulk payload missing."});try{a=JSON.parse(t)}catch{o({title:"Bulk receipt error",variant:"destructive",description:"Bulk payload invalid JSON."});return}let i=new FormData;i.set("actor_profile_id",r),i.set("items",JSON.stringify(a)),C(await J(i),"Bulk receipt queued.",()=>v(!1))};return(0,a.jsxs)(L.Card,{className:"border-border/60",children:[(0,a.jsxs)(L.CardHeader,{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[(0,a.jsx)(L.CardTitle,{className:"text-title-sm font-semibold",children:"Inventory items"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(P.Dialog,{open:f,onOpenChange:v,children:[(0,a.jsx)(P.DialogTrigger,{asChild:!0,children:(0,a.jsx)(F.Button,{variant:"outline",children:"Bulk receive"})}),(0,a.jsx)(en,{isPending:y,onSubmit:B,actorProfileId:r,items:e,locations:i,organizations:S})]}),(0,a.jsxs)(P.Dialog,{open:d,onOpenChange:c,children:[(0,a.jsx)(P.DialogTrigger,{asChild:!0,children:(0,a.jsx)(F.Button,{children:"Create item"})}),(0,a.jsx)(ea,{title:"Create inventory item",actionLabel:"Create item",defaultValues:null,categories:T,locations:i,isPending:y,onSubmit:_,actorProfileId:r})]})]})]}),(0,a.jsx)(L.CardContent,{className:"overflow-x-auto",children:(0,a.jsxs)(R.Table,{children:[(0,a.jsx)(R.TableHeader,{children:(0,a.jsxs)(R.TableRow,{children:[(0,a.jsx)(R.TableHead,{children:"Item"}),(0,a.jsx)(R.TableHead,{children:"Category"}),(0,a.jsx)(R.TableHead,{children:"Unit"}),(0,a.jsx)(R.TableHead,{className:"text-right",children:"On hand"}),(0,a.jsx)(R.TableHead,{className:"text-right",children:"Threshold"}),(0,a.jsx)(R.TableHead,{className:"text-right",children:"Status"}),(0,a.jsx)(R.TableHead,{className:"text-right",children:"Actions"})]})}),(0,a.jsx)(R.TableBody,{children:e.map(e=>(0,a.jsxs)(R.TableRow,{className:e.active?void 0:"opacity-60",children:[(0,a.jsx)(R.TableCell,{className:"font-medium",children:e.name}),(0,a.jsx)(R.TableCell,{children:e.category??"—"}),(0,a.jsx)(R.TableCell,{children:e.unitType??"—"}),(0,a.jsx)(R.TableCell,{className:"text-right",children:e.onHandQuantity.toLocaleString()}),(0,a.jsx)(R.TableCell,{className:"text-right",children:null===e.minimumThreshold?"—":e.minimumThreshold.toLocaleString()}),(0,a.jsx)(R.TableCell,{className:"text-right",children:(0,a.jsx)("span",{className:e.active?"text-primary":"text-muted-foreground",children:e.active?"Active":"Inactive"})}),(0,a.jsxs)(R.TableCell,{className:"space-x-2 text-right",children:[(0,a.jsx)(F.Button,{size:"sm",variant:"outline",onClick:()=>h(e),children:"Receive"}),(0,a.jsx)(F.Button,{size:"sm",variant:"outline",onClick:()=>j(e),children:"Transfer"}),(0,a.jsx)(F.Button,{size:"sm",variant:"outline",onClick:()=>b(e),children:"Adjust"}),(0,a.jsx)(F.Button,{size:"sm",variant:"ghost",onClick:()=>u(e),children:"Edit"}),(0,a.jsx)(F.Button,{size:"sm",variant:"ghost",onClick:()=>H(e,!e.active),disabled:y,children:e.active?"Deactivate":"Activate"}),(0,a.jsx)(F.Button,{size:"sm",variant:"ghost",className:"text-destructive hover:text-destructive",onClick:()=>A(e),disabled:y,children:"Delete"})]})]},e.id))})]})}),(0,a.jsx)(L.CardFooter,{className:"text-label-sm text-muted-foreground",children:"Manage stock levels using receive, transfer, or adjust actions. Deactivating an item hides it from operational workflows without deleting historic transactions."}),(0,a.jsx)(ea,{title:"Edit inventory item",actionLabel:"Save changes",defaultValues:m,categories:T,locations:i,isPending:y,onSubmit:w,actorProfileId:r,open:null!==m,onOpenChange:e=>!e&&u(null)}),(0,a.jsx)(ei,{item:x,locations:i,organizations:S,isPending:y,onClose:()=>h(null),onSubmit:I,actorProfileId:r}),(0,a.jsx)(el,{item:p,locations:i,isPending:y,onClose:()=>j(null),onSubmit:D,actorProfileId:r}),(0,a.jsx)(es,{item:g,locations:i,isPending:y,onClose:()=>b(null),onSubmit:k,actorProfileId:r})]})}function ea({title:e,actionLabel:t,defaultValues:i,categories:l,locations:s,onSubmit:r,actorProfileId:n,isPending:o,open:d,onOpenChange:c}){return(0,a.jsx)(P.Dialog,{open:d,onOpenChange:c,children:(0,a.jsxs)(P.DialogContent,{className:"max-w-xl",children:[(0,a.jsxs)(P.DialogHeader,{children:[(0,a.jsx)(P.DialogTitle,{children:e}),(0,a.jsx)(P.DialogDescription,{children:"Provide descriptive names and categories so outreach staff can find items quickly across locations."})]}),(0,a.jsxs)("form",{action:r,className:"space-y-4",children:[(0,a.jsx)("input",{type:"hidden",name:"actor_profile_id",value:n}),i?(0,a.jsx)("input",{type:"hidden",name:"item_id",value:i.id}):null,(0,a.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,a.jsx)(et,{label:"Name",name:"name",defaultValue:i?.name,required:!0}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(z.Label,{htmlFor:"item_category",children:"Category"}),(0,a.jsx)("input",{list:"inventory-categories",name:"category",id:"item_category",defaultValue:i?.category??"",required:!0,className:"rounded-md border border-input bg-background px-3 py-2 text-body-md shadow-sm focus:outline-none"}),(0,a.jsx)("datalist",{id:"inventory-categories",children:l.map(e=>(0,a.jsx)("option",{value:e},e))})]}),(0,a.jsx)(et,{label:"Unit type",name:"unit_type",defaultValue:i?.unitType,required:!0}),(0,a.jsx)(et,{label:"Supplier",name:"supplier",defaultValue:i?.supplier??""})]}),(0,a.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,a.jsx)(et,{label:"Minimum threshold",name:"minimum_threshold",type:"number",min:0,defaultValue:i?.minimumThreshold??"",placeholder:"Optional"}),(0,a.jsx)(et,{label:"Unit cost",name:"cost_per_unit",type:"number",min:0,step:"0.01",defaultValue:i?.costPerUnit??"",placeholder:"Optional"})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(z.Label,{htmlFor:"item_description",children:"Description"}),(0,a.jsx)(V.Textarea,{id:"item_description",name:"description",rows:3,defaultValue:i?.description??"",placeholder:"Optional context for outreach staff"})]}),i?null:(0,a.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,a.jsx)(et,{label:"Initial stock",name:"initial_stock",type:"number",min:0,placeholder:"0"}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(z.Label,{htmlFor:"initial_location_id",children:"Initial location"}),(0,a.jsxs)(M.Select,{name:"initial_location_id",children:[(0,a.jsx)(M.SelectTrigger,{id:"initial_location_id",children:(0,a.jsx)(M.SelectValue,{placeholder:"Select location"})}),(0,a.jsxs)(M.SelectContent,{children:[(0,a.jsx)(M.SelectItem,{value:"",children:"None"}),s.map(e=>(0,a.jsx)(M.SelectItem,{value:e.id,children:e.name},e.id))]})]}),(0,a.jsx)("p",{className:"text-label-sm text-muted-foreground",children:"Required if you record initial stock above zero."})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(q.Checkbox,{id:"item_active",name:"active",defaultChecked:i?.active??!0}),(0,a.jsx)(z.Label,{htmlFor:"item_active",className:"text-body-md text-muted-foreground",children:"Item is active in operations"})]}),(0,a.jsx)(P.DialogFooter,{className:"pt-4",children:(0,a.jsx)(F.Button,{type:"submit",disabled:o,children:t})})]})]})})}function et({label:e,name:t,defaultValue:i,placeholder:l,type:s="text",required:r,min:n,step:o}){return(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(z.Label,{htmlFor:t,children:e}),(0,a.jsx)(B.Input,{id:t,name:t,type:s,defaultValue:i??"",placeholder:l,required:r,min:n,step:o})]})}function ei({item:e,locations:t,organizations:i,onSubmit:l,onClose:s,actorProfileId:r,isPending:n}){return(0,a.jsx)(P.Dialog,{open:!!e,onOpenChange:e=>!e&&s(),children:(0,a.jsxs)(P.DialogContent,{className:"max-w-lg",children:[(0,a.jsxs)(P.DialogHeader,{children:[(0,a.jsx)(P.DialogTitle,{children:"Receive stock"}),(0,a.jsx)(P.DialogDescription,{children:"Record incoming donations or purchases. Quantities increase stock at the selected location."})]}),e?(0,a.jsxs)("form",{action:l,className:"space-y-4",children:[(0,a.jsx)("input",{type:"hidden",name:"actor_profile_id",value:r}),(0,a.jsx)("input",{type:"hidden",name:"item_id",value:e.id}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)(z.Label,{children:"Item"}),(0,a.jsx)("p",{className:"text-body-md font-medium text-on-surface",children:e.name})]}),(0,a.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,a.jsx)(et,{label:"Quantity",name:"quantity",type:"number",min:0,required:!0,placeholder:"0"}),(0,a.jsx)(et,{label:"Unit cost",name:"unit_cost",type:"number",min:0,step:"0.01",placeholder:"0.00"})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(z.Label,{htmlFor:"receive_location",children:"Location"}),(0,a.jsxs)(M.Select,{name:"location_id",required:!0,children:[(0,a.jsx)(M.SelectTrigger,{id:"receive_location",children:(0,a.jsx)(M.SelectValue,{placeholder:"Select location"})}),(0,a.jsx)(M.SelectContent,{children:t.map(e=>(0,a.jsx)(M.SelectItem,{value:e.id,children:e.name},e.id))})]})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(z.Label,{htmlFor:"receive_source",children:"Source type"}),(0,a.jsxs)(M.Select,{name:"source_type",children:[(0,a.jsx)(M.SelectTrigger,{id:"receive_source",children:(0,a.jsx)(M.SelectValue,{placeholder:"Select source"})}),(0,a.jsxs)(M.SelectContent,{children:[(0,a.jsx)(M.SelectItem,{value:"",children:"None"}),(0,a.jsx)(M.SelectItem,{value:"donation",children:"Donation"}),(0,a.jsx)(M.SelectItem,{value:"purchase",children:"Purchase"}),(0,a.jsx)(M.SelectItem,{value:"transfer_in",children:"Transfer in"}),(0,a.jsx)(M.SelectItem,{value:"adjustment",children:"Adjustment"})]})]})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(z.Label,{htmlFor:"provider_org",children:"Provider organisation"}),(0,a.jsxs)(M.Select,{name:"provider_org_id",children:[(0,a.jsx)(M.SelectTrigger,{id:"provider_org",children:(0,a.jsx)(M.SelectValue,{placeholder:"None"})}),(0,a.jsxs)(M.SelectContent,{children:[(0,a.jsx)(M.SelectItem,{value:"",children:"None"}),i.map(e=>(0,a.jsx)(M.SelectItem,{value:String(e.id),children:e.name},e.id))]})]})]}),(0,a.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,a.jsx)(et,{label:"Lot number",name:"lot_number",placeholder:"Optional"}),(0,a.jsx)(et,{label:"Expiry date",name:"expiry_date",type:"date",defaultValue:Z})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(z.Label,{htmlFor:"receive_notes",children:"Notes"}),(0,a.jsx)(V.Textarea,{id:"receive_notes",name:"notes",rows:3,placeholder:"Optional context"})]}),(0,a.jsx)(P.DialogFooter,{className:"pt-4",children:(0,a.jsx)(F.Button,{type:"submit",disabled:n,children:"Record receipt"})})]}):null]})})}function el({item:e,locations:t,onSubmit:i,onClose:l,actorProfileId:s,isPending:r}){return(0,a.jsx)(P.Dialog,{open:!!e,onOpenChange:e=>!e&&l(),children:(0,a.jsxs)(P.DialogContent,{className:"max-w-lg",children:[(0,a.jsxs)(P.DialogHeader,{children:[(0,a.jsx)(P.DialogTitle,{children:"Transfer stock"}),(0,a.jsx)(P.DialogDescription,{children:"Move stock from one location to another."})]}),e?(0,a.jsxs)("form",{action:i,className:"space-y-4",children:[(0,a.jsx)("input",{type:"hidden",name:"actor_profile_id",value:s}),(0,a.jsx)("input",{type:"hidden",name:"item_id",value:e.id}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)(z.Label,{children:"Item"}),(0,a.jsx)("p",{className:"text-body-md font-medium text-on-surface",children:e.name})]}),(0,a.jsx)(et,{label:"Quantity",name:"quantity",type:"number",min:0,required:!0,placeholder:"0"}),(0,a.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,a.jsx)(er,{label:"From",name:"from_location_id",locations:t,required:!0}),(0,a.jsx)(er,{label:"To",name:"to_location_id",locations:t,required:!0})]}),(0,a.jsx)(et,{label:"Notes",name:"notes",placeholder:"Optional"}),(0,a.jsx)(P.DialogFooter,{className:"pt-4",children:(0,a.jsx)(F.Button,{type:"submit",disabled:r,children:"Transfer"})})]}):null]})})}function es({item:e,locations:t,onSubmit:i,onClose:l,actorProfileId:s,isPending:r}){return(0,a.jsx)(P.Dialog,{open:!!e,onOpenChange:e=>!e&&l(),children:(0,a.jsxs)(P.DialogContent,{className:"max-w-lg",children:[(0,a.jsxs)(P.DialogHeader,{children:[(0,a.jsx)(P.DialogTitle,{children:"Adjust stock"}),(0,a.jsx)(P.DialogDescription,{children:"Apply corrections for damaged or counted stock."})]}),e?(0,a.jsxs)("form",{action:i,className:"space-y-4",children:[(0,a.jsx)("input",{type:"hidden",name:"actor_profile_id",value:s}),(0,a.jsx)("input",{type:"hidden",name:"item_id",value:e.id}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)(z.Label,{children:"Item"}),(0,a.jsx)("p",{className:"text-body-md font-medium text-on-surface",children:e.name})]}),(0,a.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,a.jsx)(er,{label:"Location",name:"location_id",locations:t,required:!0}),(0,a.jsx)(et,{label:"Quantity adjustment",name:"quantity_delta",type:"number",placeholder:"Use negative numbers for reductions",required:!0})]}),(0,a.jsx)(et,{label:"Reason",name:"reason",placeholder:"e.g., Damaged during transit",required:!0}),(0,a.jsx)(et,{label:"Notes",name:"notes",placeholder:"Optional"}),(0,a.jsx)(P.DialogFooter,{className:"pt-4",children:(0,a.jsx)(F.Button,{type:"submit",disabled:r,children:"Apply adjustment"})})]}):null]})})}function er({label:e,name:t,locations:i,required:l}){return(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(z.Label,{htmlFor:t,children:e}),(0,a.jsxs)(M.Select,{name:t,required:l,children:[(0,a.jsx)(M.SelectTrigger,{id:t,children:(0,a.jsx)(M.SelectValue,{placeholder:"Select location"})}),(0,a.jsx)(M.SelectContent,{children:i.map(e=>(0,a.jsx)(M.SelectItem,{value:e.id,children:e.name},e.id))})]})]})}function en({isPending:e,onSubmit:t,actorProfileId:i,items:l,locations:s,organizations:r}){return(0,a.jsxs)(P.DialogContent,{className:"max-w-2xl",children:[(0,a.jsxs)(P.DialogHeader,{children:[(0,a.jsx)(P.DialogTitle,{children:"Bulk receive stock"}),(0,a.jsx)(P.DialogDescription,{children:"Upload multiple receipts at once by pasting JSON payloads. Generated templates appear below to help format data quickly."})]}),(0,a.jsxs)("form",{action:t,className:"space-y-4",children:[(0,a.jsx)("input",{type:"hidden",name:"actor_profile_id",value:i}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(z.Label,{htmlFor:"bulk_items_json",children:"Receipts JSON"}),(0,a.jsx)(V.Textarea,{id:"bulk_items_json",name:"items_json",rows:8,className:"font-mono text-label-sm",placeholder:'{"items":[{"itemId":"...","quantity":10,"locationId":"..."}]}',required:!0}),(0,a.jsxs)("p",{className:"text-label-sm text-muted-foreground",children:["Include ",(0,a.jsx)("code",{children:"itemId"}),", ",(0,a.jsx)("code",{children:"quantity"}),", optional ",(0,a.jsx)("code",{children:"locationId"}),", ",(0,a.jsx)("code",{children:"unitCost"}),", and ",(0,a.jsx)("code",{children:"notes"})," for each entry."]})]}),(0,a.jsx)(P.DialogFooter,{children:(0,a.jsx)(F.Button,{type:"submit",disabled:e,children:"Process receipts"})})]}),(0,a.jsx)(eo,{items:l,locations:s,organizations:r})]})}function eo({items:e,locations:i,organizations:l}){let s=(0,t.useMemo)(()=>{let a=e[0],t=i[0],s=l[0];return JSON.stringify({items:[{itemId:a?.id??"ITEM_ID",quantity:10,locationId:t?.id??"LOCATION_ID",unitCost:2.5,notes:"Donation from community partner"}],sourceType:"donation",providerOrganizationId:s?.id??void 0,defaultLocationId:t?.id??void 0,globalNotes:"Monthly restock"},null,2)},[e,i,l]);return(0,a.jsxs)("div",{className:"rounded-lg border border-dashed border-muted-foreground/40 bg-muted/20 p-4 text-label-sm text-muted-foreground",children:[(0,a.jsx)("p",{className:"mb-2 font-medium text-on-surface",children:"Template example"}),(0,a.jsx)("pre",{className:"whitespace-pre-wrap break-words font-mono text-label-sm leading-relaxed",children:s})]})}var ed=(0,E.createServerReference)("40c153c0874e0597d5f04a817d0928aefa366716e4",E.callServer,void 0,E.findSourceMapURL,"createInventoryLocationAction"),ec=(0,E.createServerReference)("40f775c10ca9cf9d6c308ac61d1b52e8a140be2f0e",E.callServer,void 0,E.findSourceMapURL,"deleteInventoryLocationAction"),em=(0,E.createServerReference)("40fd8e40b97335e8e630438a39271991fb2f4f520b",E.callServer,void 0,E.findSourceMapURL,"toggleInventoryLocationAction"),eu=(0,E.createServerReference)("403014c4d0ee7a583a8a2c8c5a314df163558e4736",E.callServer,void 0,E.findSourceMapURL,"updateInventoryLocationAction");function ex({locations:e,actorProfileId:i,canManageLocations:l}){let s=(0,O.useRouter)(),{toast:r}=(0,U.useToast)(),[n,o]=(0,t.useState)(!1),[d,c]=(0,t.useState)(null),[m,u]=(0,t.useTransition)(),x=(e,a,t)=>{e.success?(t&&t(),r({title:"Location updated",description:a}),u(()=>s.refresh())):r({title:"Location error",variant:"destructive",description:e.error??"Action failed."})},h=async e=>{e.set("actor_profile_id",i),x(await ed(e),"Location created.",()=>o(!1))},p=async e=>{e.set("actor_profile_id",i),x(await eu(e),"Location updated.",()=>c(null))},j=async(e,a)=>{let t=new FormData;t.set("actor_profile_id",i),t.set("location_id",e.id),t.set("active",String(a)),x(await em(t),a?"Location activated.":"Location deactivated.")},g=async e=>{let a=new FormData;a.set("actor_profile_id",i),a.set("location_id",e.id),x(await ec(a),"Location deleted.")};return(0,a.jsxs)(L.Card,{className:"border-border/60",children:[(0,a.jsxs)(L.CardHeader,{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(L.CardTitle,{className:"text-title-sm font-semibold",children:"Locations"}),(0,a.jsx)("p",{className:"text-body-md text-muted-foreground",children:"Warehouses, outreach lockers, and mobile units that hold inventory."}),l?null:(0,a.jsx)("p",{className:"text-label-sm text-warning-foreground",children:"Viewing only: only IHARC admins can add or edit locations."})]}),(0,a.jsxs)(P.Dialog,{open:n,onOpenChange:o,children:[(0,a.jsx)(P.DialogTrigger,{asChild:!0,children:(0,a.jsx)(F.Button,{disabled:!l,children:"Create location"})}),(0,a.jsx)(eh,{title:"Create location",actionLabel:"Create location",actorProfileId:i,onSubmit:h,isPending:m,canManageLocations:l})]})]}),(0,a.jsx)(L.CardContent,{className:"overflow-x-auto",children:(0,a.jsxs)(R.Table,{children:[(0,a.jsx)(R.TableHeader,{children:(0,a.jsxs)(R.TableRow,{children:[(0,a.jsx)(R.TableHead,{children:"Name"}),(0,a.jsx)(R.TableHead,{children:"Code"}),(0,a.jsx)(R.TableHead,{children:"Type"}),(0,a.jsx)(R.TableHead,{children:"Status"}),(0,a.jsx)(R.TableHead,{className:"text-right",children:"Actions"})]})}),(0,a.jsx)(R.TableBody,{children:e.map(e=>(0,a.jsxs)(R.TableRow,{className:e.active?void 0:"opacity-60",children:[(0,a.jsx)(R.TableCell,{className:"font-medium",children:e.name}),(0,a.jsx)(R.TableCell,{children:e.code??"—"}),(0,a.jsx)(R.TableCell,{children:e.type??"—"}),(0,a.jsx)(R.TableCell,{children:(0,a.jsx)("span",{className:e.active?"text-primary":"text-muted-foreground",children:e.active?"Active":"Inactive"})}),(0,a.jsxs)(R.TableCell,{className:"space-x-2 text-right",children:[(0,a.jsx)(F.Button,{size:"sm",variant:"outline",onClick:()=>c(e),disabled:!l,children:"Edit"}),(0,a.jsx)(F.Button,{size:"sm",variant:"ghost",onClick:()=>j(e,!e.active),disabled:m||!l,children:e.active?"Deactivate":"Activate"}),(0,a.jsx)(F.Button,{size:"sm",variant:"ghost",className:"text-destructive hover:text-destructive",onClick:()=>g(e),disabled:m||!l,children:"Delete"})]})]},e.id))})]})}),(0,a.jsx)(L.CardFooter,{className:"text-label-sm text-muted-foreground",children:"Deleting a location is only allowed when no stock remains and no transactions reference it. Otherwise deactivate to hide it from workflows."}),(0,a.jsx)(eh,{title:"Edit location",actionLabel:"Save changes",actorProfileId:i,onSubmit:p,isPending:m,defaultValues:d,open:null!==d,onOpenChange:e=>!e&&c(null),canManageLocations:l})]})}function eh({title:e,actionLabel:t,actorProfileId:i,onSubmit:l,isPending:s,defaultValues:r,open:n,onOpenChange:o,canManageLocations:d}){return(0,a.jsx)(P.Dialog,{open:n,onOpenChange:o,children:(0,a.jsxs)(P.DialogContent,{className:"max-w-lg",children:[(0,a.jsxs)(P.DialogHeader,{children:[(0,a.jsx)(P.DialogTitle,{children:e}),(0,a.jsx)(P.DialogDescription,{children:"Track detailed addresses so deliveries and outreach staff know where supplies live."})]}),(0,a.jsxs)("form",{action:l,className:"space-y-4",children:[(0,a.jsx)("input",{type:"hidden",name:"actor_profile_id",value:i}),r?(0,a.jsx)("input",{type:"hidden",name:"location_id",value:r.id}):null,(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(z.Label,{htmlFor:"location_name",children:"Name"}),(0,a.jsx)(B.Input,{id:"location_name",name:"name",defaultValue:r?.name??"",required:!0,disabled:!d})]}),(0,a.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,a.jsx)(ep,{label:"Code",name:"code",defaultValue:r?.code??"",placeholder:"Short code",required:!0,disabled:!d}),(0,a.jsx)(ep,{label:"Type",name:"type",defaultValue:r?.type??"",placeholder:"e.g., Warehouse",required:!0,disabled:!d})]}),(0,a.jsx)(ep,{label:"Address",name:"address",defaultValue:r?.address??"",placeholder:"Street, city",disabled:!d}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(q.Checkbox,{id:"location_active",name:"active",defaultChecked:r?.active??!0,disabled:!d}),(0,a.jsx)(z.Label,{htmlFor:"location_active",className:"text-body-md text-muted-foreground",children:"Location is active"})]}),(0,a.jsx)(P.DialogFooter,{children:(0,a.jsx)(F.Button,{type:"submit",disabled:s||!d,children:t})})]})]})})}function ep({label:e,name:t,defaultValue:i,placeholder:l,required:s,disabled:r}){return(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(z.Label,{htmlFor:t,children:e}),(0,a.jsx)(B.Input,{id:t,name:t,defaultValue:i??"",placeholder:l,required:s,disabled:r})]})}var ej=(0,E.createServerReference)("403263e68d5afcf0e54388f8c3c082e81b41c0e5e6",E.callServer,void 0,E.findSourceMapURL,"createInventoryOrganizationAction"),eg=(0,E.createServerReference)("408435383f391874e84eaed865e5e05045fc70724a",E.callServer,void 0,E.findSourceMapURL,"deactivateInventoryOrganizationAction"),eb=(0,E.createServerReference)("40e5c60a8c1676edfc87099175fd266ba32884246b",E.callServer,void 0,E.findSourceMapURL,"activateInventoryOrganizationAction"),ef=(0,E.createServerReference)("40b57083cd9a496d5383e32b42398020dd1ffbba71",E.callServer,void 0,E.findSourceMapURL,"updateInventoryOrganizationAction");function ev({organizations:e,actorProfileId:i}){let l=(0,O.useRouter)(),{toast:s}=(0,U.useToast)(),[r,n]=(0,t.useState)(!1),[o,d]=(0,t.useState)(null),[c,m]=(0,t.useTransition)(),u=(e,a,t)=>{e.success?(t&&t(),s({title:"Organisation updated",description:a}),m(()=>l.refresh())):s({title:"Organisation error",variant:"destructive",description:e.error??"Action failed."})},x=async e=>{e.set("actor_profile_id",i),u(await ej(e),"Organization saved.",()=>n(!1))},h=async e=>{e.set("actor_profile_id",i),u(await ef(e),"Organization updated.",()=>d(null))},p=async e=>{let a=new FormData;a.set("actor_profile_id",i),a.set("organization_id",String(e.id)),u(await eg(a),"Organization deactivated.")},j=async e=>{let a=new FormData;a.set("actor_profile_id",i),a.set("organization_id",String(e.id)),u(await eb(a),"Organization reactivated.")};return(0,a.jsxs)(L.Card,{className:"border-border/60",children:[(0,a.jsxs)(L.CardHeader,{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(L.CardTitle,{className:"text-title-sm font-semibold",children:"Partner organisations"}),(0,a.jsx)("p",{className:"text-body-md text-muted-foreground",children:"Track donors, suppliers, and partners for accurate receipt attribution and reporting."})]}),(0,a.jsxs)(P.Dialog,{open:r,onOpenChange:n,children:[(0,a.jsx)(P.DialogTrigger,{asChild:!0,children:(0,a.jsx)(F.Button,{children:"Add organisation"})}),(0,a.jsx)(ey,{title:"Add organisation",actionLabel:"Save organisation",actorProfileId:i,onSubmit:x,isPending:c})]})]}),(0,a.jsx)(L.CardContent,{className:"overflow-x-auto",children:(0,a.jsxs)(R.Table,{children:[(0,a.jsx)(R.TableHeader,{children:(0,a.jsxs)(R.TableRow,{children:[(0,a.jsx)(R.TableHead,{children:"Name"}),(0,a.jsx)(R.TableHead,{children:"Website"}),(0,a.jsx)(R.TableHead,{children:"Status"}),(0,a.jsx)(R.TableHead,{className:"text-right",children:"Actions"})]})}),(0,a.jsx)(R.TableBody,{children:e.map(e=>(0,a.jsxs)(R.TableRow,{className:e.isActive?void 0:"opacity-60",children:[(0,a.jsx)(R.TableCell,{className:"font-medium",children:e.name}),(0,a.jsx)(R.TableCell,{children:e.website??"—"}),(0,a.jsx)(R.TableCell,{children:(0,a.jsx)("span",{className:e.isActive?"text-primary":"text-muted-foreground",children:e.isActive?"Active":"Inactive"})}),(0,a.jsxs)(R.TableCell,{className:"space-x-2 text-right",children:[(0,a.jsx)(F.Button,{size:"sm",variant:"outline",onClick:()=>d(e),children:"Edit"}),e.isActive?(0,a.jsx)(F.Button,{size:"sm",variant:"ghost",className:"text-destructive hover:text-destructive",onClick:()=>p(e),disabled:c,children:"Deactivate"}):(0,a.jsx)(F.Button,{size:"sm",variant:"ghost",className:"text-tertiary hover:text-tertiary",onClick:()=>j(e),disabled:c,children:"Reactivate"})]})]},e.id))})]})}),(0,a.jsx)(L.CardFooter,{className:"text-label-sm text-muted-foreground",children:"Deactivate partners to pause new activity. Reactivate them when donations resume so historic receipts stay intact."}),(0,a.jsx)(ey,{title:"Edit organization",actionLabel:"Save changes",actorProfileId:i,onSubmit:h,isPending:c,defaultValues:o,open:null!==o,onOpenChange:e=>!e&&d(null)})]})}function ey({title:e,actionLabel:t,actorProfileId:i,onSubmit:l,isPending:s,defaultValues:r,open:n,onOpenChange:o}){return(0,a.jsx)(P.Dialog,{open:n,onOpenChange:o,children:(0,a.jsxs)(P.DialogContent,{className:"max-w-lg",children:[(0,a.jsxs)(P.DialogHeader,{children:[(0,a.jsx)(P.DialogTitle,{children:e}),(0,a.jsx)(P.DialogDescription,{children:"Capture supplier details and websites to simplify follow-up for receipts."})]}),(0,a.jsxs)("form",{action:l,className:"space-y-4",children:[(0,a.jsx)("input",{type:"hidden",name:"actor_profile_id",value:i}),r?(0,a.jsx)("input",{type:"hidden",name:"organization_id",value:String(r.id)}):null,(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(z.Label,{htmlFor:"org_name",children:"Name"}),(0,a.jsx)(B.Input,{id:"org_name",name:"name",defaultValue:r?.name??"",required:!0})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(z.Label,{htmlFor:"org_website",children:"Website"}),(0,a.jsx)(B.Input,{id:"org_website",name:"website",type:"url",defaultValue:r?.website??"",placeholder:"https://example.ca"})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(z.Label,{htmlFor:"org_description",children:"Description"}),(0,a.jsx)(V.Textarea,{id:"org_description",name:"description",rows:3,defaultValue:r?.description??""})]}),(0,a.jsx)(P.DialogFooter,{children:(0,a.jsx)(F.Button,{type:"submit",disabled:s,children:t})})]})]})})}var eN=(0,E.createServerReference)("401deed810cec397afe0dde30ec44d021f5dd2c3e9",E.callServer,void 0,E.findSourceMapURL,"updateInventoryTransactionSourceAction");function eT({receipts:e,organizations:i,actorProfileId:l}){let[s,r]=(0,t.useState)(""),[n,o]=(0,t.useState)(null),[d,c]=(0,t.useTransition)(),m=(0,O.useRouter)(),{toast:u}=(0,U.useToast)(),x=(0,t.useMemo)(()=>{if(!s)return e;let a=s.toLowerCase();return e.filter(e=>[e.itemName,e.locationName??"",e.providerOrgName??"",e.notes??""].some(e=>e.toLowerCase().includes(a)))},[e,s]),h=async e=>{e.set("actor_profile_id",l);let a=await eN(e);a.success?(u({title:"Receipt updated",description:"Receipt source updated."}),o(null),c(()=>m.refresh())):u({title:"Receipt error",variant:"destructive",description:a.error??"Failed to update receipt."})};return(0,a.jsxs)(L.Card,{className:"border-border/60",children:[(0,a.jsxs)(L.CardHeader,{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[(0,a.jsx)(L.CardTitle,{className:"text-title-sm font-semibold",children:"Receipts"}),(0,a.jsx)(B.Input,{className:"w-full sm:w-64",placeholder:"Search receipts",value:s,onChange:e=>r(e.target.value)})]}),(0,a.jsx)(L.CardContent,{className:"overflow-x-auto",children:(0,a.jsxs)(R.Table,{children:[(0,a.jsx)(R.TableHeader,{children:(0,a.jsxs)(R.TableRow,{children:[(0,a.jsx)(R.TableHead,{children:"Item"}),(0,a.jsx)(R.TableHead,{children:"Location"}),(0,a.jsx)(R.TableHead,{children:"Source"}),(0,a.jsx)(R.TableHead,{className:"text-right",children:"Quantity"}),(0,a.jsx)(R.TableHead,{className:"text-right",children:"Received"}),(0,a.jsx)(R.TableHead,{className:"text-right",children:"Actions"})]})}),(0,a.jsx)(R.TableBody,{children:x.map(e=>(0,a.jsxs)(R.TableRow,{children:[(0,a.jsx)(R.TableCell,{className:"font-medium",children:e.itemName}),(0,a.jsx)(R.TableCell,{children:e.locationName??"—"}),(0,a.jsx)(R.TableCell,{children:e.providerOrgName??e.refType??"—"}),(0,a.jsx)(R.TableCell,{className:"text-right",children:e.qty.toLocaleString()}),(0,a.jsx)(R.TableCell,{className:"text-right",children:new Date(e.createdAt).toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"})}),(0,a.jsx)(R.TableCell,{className:"text-right",children:(0,a.jsx)(F.Button,{size:"sm",variant:"outline",onClick:()=>o(e),children:"Update source"})})]},e.id))})]})}),(0,a.jsx)(eS,{receipt:n,organizations:i,actorProfileId:l,isPending:d,onClose:()=>o(null),onSubmit:h})]})}function eS({receipt:e,organizations:t,actorProfileId:i,isPending:l,onSubmit:s,onClose:r}){return(0,a.jsx)(P.Dialog,{open:!!e,onOpenChange:e=>!e&&r(),children:(0,a.jsxs)(P.DialogContent,{className:"max-w-lg",children:[(0,a.jsxs)(P.DialogHeader,{children:[(0,a.jsx)(P.DialogTitle,{children:"Update receipt source"}),(0,a.jsx)(P.DialogDescription,{children:"Attach or correct the provider for this receipt. This keeps reporting accurate across teams."})]}),e?(0,a.jsxs)("form",{action:s,className:"space-y-4",children:[(0,a.jsx)("input",{type:"hidden",name:"actor_profile_id",value:i}),(0,a.jsx)("input",{type:"hidden",name:"transaction_id",value:e.id}),(0,a.jsxs)("div",{className:"grid gap-1",children:[(0,a.jsx)(z.Label,{children:"Item"}),(0,a.jsx)("p",{className:"text-body-md font-medium text-on-surface",children:e.itemName})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(z.Label,{htmlFor:"receipt_source_type",children:"Source type"}),(0,a.jsxs)("select",{id:"receipt_source_type",name:"source_type",defaultValue:e.refType??"",className:"rounded-md border border-input bg-background px-3 py-2 text-body-md shadow-sm focus:outline-none",children:[(0,a.jsx)("option",{value:"",children:"Unset"}),(0,a.jsx)("option",{value:"donation",children:"Donation"}),(0,a.jsx)("option",{value:"purchase",children:"Purchase"}),(0,a.jsx)("option",{value:"transfer_in",children:"Transfer in"}),(0,a.jsx)("option",{value:"adjustment",children:"Adjustment"})]})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(z.Label,{htmlFor:"receipt_provider",children:"Provider organisation"}),(0,a.jsxs)("select",{id:"receipt_provider",name:"provider_org_id",defaultValue:e.providerOrgId?.toString()??"",className:"rounded-md border border-input bg-background px-3 py-2 text-body-md shadow-sm focus:outline-none",children:[(0,a.jsx)("option",{value:"",children:"None"}),t.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(z.Label,{htmlFor:"receipt_notes",children:"Notes"}),(0,a.jsx)(B.Input,{id:"receipt_notes",name:"notes",defaultValue:e.notes??"",placeholder:"Optional comments"})]}),(0,a.jsx)(P.DialogFooter,{children:(0,a.jsx)(F.Button,{type:"submit",disabled:l,children:"Save changes"})})]}):null]})})}function eC({bootstrap:e,actorProfileId:i,canManageLocations:l}){let[s,r]=(0,t.useState)("dashboard");return(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsxs)(g,{value:s,onValueChange:r,className:"space-y-6",children:[(0,a.jsxs)(w,{className:"flex w-full flex-wrap justify-start gap-2 bg-transparent p-0",children:[(0,a.jsx)(I,{value:"dashboard",className:"rounded-full border px-4 py-1 text-body-md",children:"Dashboard"}),(0,a.jsx)(I,{value:"items",className:"rounded-full border px-4 py-1 text-body-md",children:"Items"}),(0,a.jsx)(I,{value:"locations",className:"rounded-full border px-4 py-1 text-body-md",children:"Locations"}),(0,a.jsx)(I,{value:"organizations",className:"rounded-full border px-4 py-1 text-body-md",children:"Organisations"}),(0,a.jsx)(I,{value:"receipts",className:"rounded-full border px-4 py-1 text-body-md",children:"Receipts"})]}),(0,a.jsx)(D,{value:"dashboard",children:(0,a.jsx)(k,{dashboard:e.dashboard})}),(0,a.jsx)(D,{value:"items",children:(0,a.jsx)(ee,{items:e.items,locations:e.locations,organizations:e.organizations,categories:e.categories,actorProfileId:i})}),(0,a.jsx)(D,{value:"locations",children:(0,a.jsx)(ex,{locations:e.locations,actorProfileId:i,canManageLocations:l})}),(0,a.jsx)(D,{value:"organizations",children:(0,a.jsx)(ev,{organizations:e.organizations,actorProfileId:i})}),(0,a.jsx)(D,{value:"receipts",children:(0,a.jsx)(eT,{receipts:e.receipts,organizations:e.organizations,actorProfileId:i})})]})})}e.s(["InventoryWorkspace",()=>eC],50320)}]);