module.exports=[93695,(a,b,c)=>{b.exports=a.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},50645,a=>{a.n(a.i(27572))},43619,a=>{a.n(a.i(79962))},13718,a=>{a.n(a.i(85523))},18198,a=>{a.n(a.i(45518))},62212,a=>{a.n(a.i(66114))},47907,a=>{a.n(a.i(39621))},68023,a=>{a.n(a.i(77290))},96774,a=>{"use strict";let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call ComposeNotificationForm() from the server but ComposeNotificationForm is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/admin/notifications/compose-form.tsx <module evaluation>","ComposeNotificationForm");a.s(["ComposeNotificationForm",0,b])},69658,a=>{"use strict";let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call ComposeNotificationForm() from the server but ComposeNotificationForm is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/admin/notifications/compose-form.tsx","ComposeNotificationForm");a.s(["ComposeNotificationForm",0,b])},95211,a=>{"use strict";a.i(96774);var b=a.i(69658);a.n(b)},79034,a=>{"use strict";let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call RecentNotifications() from the server but RecentNotifications is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/admin/notifications/recent-notifications.tsx <module evaluation>","RecentNotifications");a.s(["RecentNotifications",0,b])},89432,a=>{"use strict";let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call RecentNotifications() from the server but RecentNotifications is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/admin/notifications/recent-notifications.tsx","RecentNotifications");a.s(["RecentNotifications",0,b])},76476,a=>{"use strict";a.i(79034);var b=a.i(89432);a.n(b)},13161,a=>{"use strict";let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call RelaySettingsCard() from the server but RelaySettingsCard is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/admin/notifications/relay-settings-card.tsx <module evaluation>","RelaySettingsCard");a.s(["RelaySettingsCard",0,b])},80403,a=>{"use strict";let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call RelaySettingsCard() from the server but RelaySettingsCard is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/admin/notifications/relay-settings-card.tsx","RelaySettingsCard");a.s(["RelaySettingsCard",0,b])},93606,a=>{"use strict";a.i(13161);var b=a.i(80403);a.n(b)},91343,a=>{"use strict";var b=a.i(7997);a.i(70396);var c=a.i(73727),d=a.i(9919),e=a.i(42145),f=a.i(65108),g=a.i(95211),h=a.i(76476),i=a.i(93606),j=a.i(46592);async function k(){let a=await (0,d.createSupabaseRSCClient)(),k=await (0,f.loadPortalAccess)(a);k||(0,c.redirect)("/login?next=/admin/notifications"),k.canManageNotifications||(0,c.redirect)((0,j.resolveDefaultWorkspacePath)(k)),await (0,e.ensurePortalProfile)(a,k.userId);let l=a.schema("portal"),[m,n]=await Promise.all([l.from("profiles").select(`
          id,
          display_name,
          affiliation_type,
          organization:core.organizations(name),
          contacts:profile_contacts(contact_type, contact_value)
        `).order("display_name"),l.from("notifications").select(`
          id,
          profile_id,
          recipient_email,
          subject,
          body_text,
          body_html,
          notification_type,
          status,
          created_at,
          sent_at,
          profile:profiles(display_name)
        `).order("created_at",{ascending:!1}).limit(20)]);if(m.error)throw m.error;if(n.error)throw n.error;let o=(m.data??[]).map(a=>{let b=(Array.isArray(a.contacts)?a.contacts:a.contacts?[a.contacts]:[]).find(a=>"email"===a.contact_type),c=Array.isArray(a.organization)?a.organization[0]:a.organization??null;return{id:a.id,displayName:a.display_name,email:b?.contact_value??null,affiliation:a.affiliation_type,organizationName:c?.name??null}}),p=(n.data??[]).map(a=>{let b=Array.isArray(a.profile)?a.profile[0]:a.profile??null;return{id:a.id,profileId:a.profile_id,profileName:b?.display_name??null,recipientEmail:a.recipient_email,subject:a.subject,bodyText:a.body_text,bodyHtml:a.body_html,notificationType:a.notification_type,status:a.status,createdAt:a.created_at,sentAt:a.sent_at}}),q=!!process.env.PORTAL_ALERTS_SECRET;return(0,b.jsxs)("div",{className:"page-shell page-stack",children:[(0,b.jsxs)("header",{className:"flex flex-col gap-space-xs",children:[(0,b.jsx)("p",{className:"text-label-sm font-medium uppercase text-muted-foreground",children:"Outreach messaging"}),(0,b.jsx)("h1",{className:"text-title-lg text-on-surface sm:text-headline-sm",children:"Notifications workspace"}),(0,b.jsx)("p",{className:"max-w-3xl text-body-md text-muted-foreground sm:text-body-lg",children:"Send reminders and alerts that respect each neighbourâ€™s consent preferences. Delivery runs through Supabase notifications and the existing portal-alerts Edge Function."})]}),(0,b.jsx)(g.ComposeNotificationForm,{recipients:o,hasAlertsSecret:q}),(0,b.jsx)(i.RelaySettingsCard,{}),(0,b.jsx)(h.RecentNotifications,{notifications:p})]})}a.s(["default",()=>k,"dynamic",0,"force-dynamic"])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__c0011e22._.js.map