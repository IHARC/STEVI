module.exports=[93695,(a,b,c)=>{b.exports=a.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},50645,a=>{a.n(a.i(27572))},43619,a=>{a.n(a.i(79962))},13718,a=>{a.n(a.i(85523))},18198,a=>{a.n(a.i(45518))},62212,a=>{a.n(a.i(66114))},47907,a=>{a.n(a.i(39621))},68023,a=>{a.n(a.i(77290))},19637,a=>{"use strict";var b=a.i(7997),c=a.i(96942),d=a.i(39138),e=a.i(59797);let f=(0,c.cva)("inline-flex items-center rounded-[var(--md-sys-shape-corner-extra-small)] border px-2.5 py-0.5 text-label-sm transition-colors motion-duration-short motion-ease-standard focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}}),g={default:"brand",secondary:"supportive",destructive:"destructive",outline:"neutral"};function h({className:a,variant:c,stateLayerTone:h,...i}){let j=g[c??"default"],k=(0,e.getStateLayerClasses)(h??j);return(0,b.jsx)("div",{className:(0,d.cn)(f({variant:c}),k,a),...i})}a.s(["Badge",()=>h])},55583,a=>{"use strict";var b=a.i(7997),c=a.i(717),d=a.i(39138);let e=c.forwardRef(({className:a,type:c,...e},f)=>(0,b.jsx)("input",{type:c,className:(0,d.cn)("flex h-12 w-full rounded-lg border border-outline bg-surface px-space-md py-space-sm text-body-md text-on-surface shadow-level-1 ring-offset-surface transition placeholder:text-on-surface-variant/70 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2 focus-visible:ring-offset-surface data-[invalid=true]:border-error file:border-0 file:bg-transparent file:text-label-sm file:font-medium file:text-on-surface disabled:cursor-not-allowed disabled:opacity-60 md:h-11",a),ref:f,...e}));e.displayName="Input",a.s(["Input",()=>e])},58774,a=>{"use strict";var b=a.i(7997),c=a.i(717),d=a.i(39138);let e=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("textarea",{className:(0,d.cn)("flex min-h-[96px] w-full rounded-lg border border-outline bg-surface px-space-md py-space-sm text-body-md text-on-surface shadow-level-1 ring-offset-surface transition placeholder:text-on-surface-variant/70 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2 focus-visible:ring-offset-surface disabled:cursor-not-allowed disabled:opacity-60",a),ref:e,...c}));e.displayName="Textarea",a.s(["Textarea",()=>e])},49378,a=>{"use strict";var b=a.i(11857);let c=(0,b.registerClientReference)(function(){throw Error("Attempted to call Label() from the server but Label is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/node_modules/@radix-ui/react-label/dist/index.mjs <module evaluation>","Label"),d=(0,b.registerClientReference)(function(){throw Error("Attempted to call Root() from the server but Root is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/node_modules/@radix-ui/react-label/dist/index.mjs <module evaluation>","Root");a.s(["Label",0,c,"Root",0,d])},86751,a=>{"use strict";var b=a.i(11857);let c=(0,b.registerClientReference)(function(){throw Error("Attempted to call Label() from the server but Label is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/node_modules/@radix-ui/react-label/dist/index.mjs","Label"),d=(0,b.registerClientReference)(function(){throw Error("Attempted to call Root() from the server but Root is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/node_modules/@radix-ui/react-label/dist/index.mjs","Root");a.s(["Label",0,c,"Root",0,d])},29558,a=>{"use strict";a.i(49378);var b=a.i(86751);a.n(b)},43562,a=>{"use strict";var b=a.i(7997),c=a.i(717),d=a.i(29558),e=a.i(96942),f=a.i(39138);let g=(0,e.cva)("text-label-md font-medium leading-none text-on-surface peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),h=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)(d.Root,{ref:e,className:(0,f.cn)(g(),a),...c}));h.displayName=d.Root.displayName,a.s(["Label",()=>h])},30215,a=>{"use strict";let b=(0,a.i(1269).default)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);a.s(["Check",()=>b],30215)},96942,59797,a=>{"use strict";var b=a.i(84347);let c=a=>"boolean"==typeof a?`${a}`:0===a?"0":a,d=b.clsx;a.s(["cva",0,(a,b)=>e=>{var f;if((null==b?void 0:b.variants)==null)return d(a,null==e?void 0:e.class,null==e?void 0:e.className);let{variants:g,defaultVariants:h}=b,i=Object.keys(g).map(a=>{let b=null==e?void 0:e[a],d=null==h?void 0:h[a];if(null===b)return null;let f=c(b)||c(d);return g[a][f]}),j=e&&Object.entries(e).reduce((a,b)=>{let[c,d]=b;return void 0===d||(a[c]=d),a},{});return d(a,i,null==b||null==(f=b.compoundVariants)?void 0:f.reduce((a,b)=>{let{class:c,className:d,...e}=b;return Object.entries(e).every(a=>{let[b,c]=a;return Array.isArray(c)?c.includes({...h,...j}[b]):({...h,...j})[b]===c})?[...a,c,d]:a},[]),null==e?void 0:e.class,null==e?void 0:e.className)}],96942);let e="hover:state-layer-hover focus-visible:state-layer-focus active:state-layer-pressed",f={primary:`state-layer-color-primary ${e}`,"primary-container":`state-layer-color-primary-container ${e}`,secondary:`state-layer-color-secondary ${e}`,"secondary-container":`state-layer-color-secondary-container ${e}`,surface:`state-layer-color-surface ${e}`,"surface-container":`state-layer-color-surface-container ${e}`,inverse:`state-layer-color-inverse-surface ${e}`,error:`state-layer-color-error ${e}`},g={...f,brand:f.primary,"brand-soft":f["primary-container"],supportive:f.secondary,"supportive-container":f["secondary-container"],destructive:f.error,neutral:f.surface,"neutral-container":f["surface-container"]};function h(a){return a?g[a]:""}a.s(["getStateLayerClasses",()=>h],59797)},38904,63770,a=>{"use strict";let b,c,d;var e=a.i(7997),f=a.i(717);function g(a,b){if("function"==typeof a)return a(b);null!=a&&(a.current=b)}function h(...a){return b=>{let c=!1,d=a.map(a=>{let d=g(a,b);return c||"function"!=typeof d||(c=!0),d});if(c)return()=>{for(let b=0;b<d.length;b++){let c=d[b];"function"==typeof c?c():g(a[b],null)}}}}a.s(["composeRefs",()=>h],63770);var i=((d=f.forwardRef((a,b)=>{let{children:c,...d}=a;if(f.isValidElement(c)){var e;let a,g,i=(e=c,(g=(a=Object.getOwnPropertyDescriptor(e.props,"ref")?.get)&&"isReactWarning"in a&&a.isReactWarning)?e.ref:(g=(a=Object.getOwnPropertyDescriptor(e,"ref")?.get)&&"isReactWarning"in a&&a.isReactWarning)?e.props.ref:e.props.ref||e.ref),j=function(a,b){let c={...b};for(let d in b){let e=a[d],f=b[d];/^on[A-Z]/.test(d)?e&&f?c[d]=(...a)=>{let b=f(...a);return e(...a),b}:e&&(c[d]=e):"style"===d?c[d]={...e,...f}:"className"===d&&(c[d]=[e,f].filter(Boolean).join(" "))}return{...a,...c}}(d,c.props);return c.type!==f.Fragment&&(j.ref=b?h(b,i):i),f.cloneElement(c,j)}return f.Children.count(c)>1?f.Children.only(null):null})).displayName="Slot.SlotClone",b=d,(c=f.forwardRef((a,c)=>{let{children:d,...g}=a,h=f.Children.toArray(d),i=h.find(k);if(i){let a=i.props.children,d=h.map(b=>b!==i?b:f.Children.count(a)>1?f.Children.only(null):f.isValidElement(a)?a.props.children:null);return(0,e.jsx)(b,{...g,ref:c,children:f.isValidElement(a)?f.cloneElement(a,void 0,d):null})}return(0,e.jsx)(b,{...g,ref:c,children:d})})).displayName="Slot.Slot",c),j=Symbol("radix.slottable");function k(a){return f.isValidElement(a)&&"function"==typeof a.type&&"__radixId"in a.type&&a.type.__radixId===j}var l=a.i(96942),m=a.i(39138),n=a.i(59797);let o=(0,l.cva)("inline-flex items-center justify-center gap-space-xs whitespace-nowrap rounded-[var(--md-sys-shape-corner-extra-small)] text-label-lg transition-colors motion-duration-short motion-ease-standard focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2 focus-visible:ring-offset-surface disabled:pointer-events-none disabled:opacity-60 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-level-2 hover:bg-primary/92 focus-visible:ring-primary",destructive:"bg-destructive text-destructive-foreground shadow-level-2 hover:bg-destructive/90 focus-visible:ring-destructive",outline:"border border-outline bg-surface text-on-surface shadow-level-1 hover:bg-surface-container focus-visible:ring-primary",secondary:"bg-secondary-container text-on-secondary-container shadow-level-1 hover:bg-secondary-container/90 focus-visible:ring-secondary",ghost:"text-primary focus-visible:ring-primary",link:"text-primary underline-offset-4 hover:underline focus-visible:ring-transparent"},size:{default:"h-10 px-space-md",sm:"h-8 px-space-sm text-label-md",lg:"h-11 px-space-lg text-label-lg",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),p={default:"brand",destructive:"destructive",outline:"neutral",secondary:"supportive-container",ghost:"brand",link:null},q=f.forwardRef(({className:a,variant:b,size:c,stateLayerTone:d,asChild:f=!1,...g},h)=>{let j=p[b??"default"],k=(0,n.getStateLayerClasses)(d??j);return(0,e.jsx)(f?i:"button",{className:(0,m.cn)(o({variant:b,size:c}),k,a),ref:h,...g})});q.displayName="Button",a.s(["Button",()=>q],38904)},22359,a=>{"use strict";var b=a.i(7997),c=a.i(717),d=a.i(39138);let e={indicator:"var(--md-sys-spacing-xs)",control:"calc(var(--md-sys-spacing-sm) - (var(--md-sys-spacing-2xs)/2))",xs:"var(--md-sys-size-icon-xs)",sm:"var(--md-sys-size-icon-sm)",md:"var(--md-sys-size-icon-md)",lg:"var(--md-sys-size-icon-lg)"},f=c.forwardRef(({icon:a,className:c,size:f="md",strokeWidth:g=1.5,decorative:h=!0,style:i,...j},k)=>{let l=e[f]??e.md;return(0,b.jsx)(a,{ref:k,"aria-hidden":!!h||void 0,role:h?void 0:"img",focusable:"false",className:(0,d.cn)("shrink-0 text-inherit",c),style:{width:l,height:l,...i},strokeWidth:g,...j})});f.displayName="Icon",a.s(["Icon",0,f])},1269,a=>{"use strict";var b=a.i(717);let c=a=>{let b=a.replace(/^([A-Z])|[\s-_]+(\w)/g,(a,b,c)=>c?c.toUpperCase():b.toLowerCase());return b.charAt(0).toUpperCase()+b.slice(1)},d=(...a)=>a.filter((a,b,c)=>!!a&&""!==a.trim()&&c.indexOf(a)===b).join(" ").trim();var e={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let f=(0,b.forwardRef)(({color:a="currentColor",size:c=24,strokeWidth:f=2,absoluteStrokeWidth:g,className:h="",children:i,iconNode:j,...k},l)=>(0,b.createElement)("svg",{ref:l,...e,width:c,height:c,stroke:a,strokeWidth:g?24*Number(f)/Number(c):f,className:d("lucide",h),...!i&&!(a=>{for(let b in a)if(b.startsWith("aria-")||"role"===b||"title"===b)return!0})(k)&&{"aria-hidden":"true"},...k},[...j.map(([a,c])=>(0,b.createElement)(a,c)),...Array.isArray(i)?i:[i]])),g=(a,e)=>{let g=(0,b.forwardRef)(({className:g,...h},i)=>(0,b.createElement)(f,{ref:i,iconNode:e,className:d(`lucide-${c(a).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${a}`,g),...h}));return g.displayName=c(a),g};a.s(["default",()=>g],1269)},83667,a=>{"use strict";function b(a,c=0){if("number"==typeof a)return Number.isFinite(a)?a:c;if("string"==typeof a){let b=Number.parseFloat(a);return Number.isFinite(b)?b:c}return"bigint"==typeof a?Number(a):c}function c(a,b=!1){if("boolean"==typeof a)return a;if("number"==typeof a)return 0!==a;if("string"==typeof a){let b=a.toLowerCase();return"true"===b||"1"===b}return b}function d(a){return{id:String(a.id),name:String(a.name??""),description:"string"==typeof a.description?a.description:null,category:"string"==typeof a.category?a.category:null,unitType:"string"==typeof a.unit_type?a.unit_type:null,minimumThreshold:null===a.minimum_threshold||void 0===a.minimum_threshold?null:b(a.minimum_threshold),costPerUnit:null===a.cost_per_unit||void 0===a.cost_per_unit?null:b(a.cost_per_unit),supplier:"string"==typeof a.supplier?a.supplier:null,active:c(a.active,!0),onHandQuantity:b(a.onhand_qty),committedQuantity:b(a.committed_qty),availableQuantity:b(a.available_qty??a.onhand_qty),lastReceiptAt:"string"==typeof a.last_receipt_at?a.last_receipt_at:null}}function e(a){let c={id:String(a.item_id??a.id??crypto.randomUUID()),name:String(a.item_name??a.name??""),category:"string"==typeof a.category?a.category:null,unitType:"string"==typeof a.unit_type?a.unit_type:null,onHandQuantity:b(a.onhand_qty??a.qty_onhand),minimumThreshold:null===a.minimum_threshold||void 0===a.minimum_threshold?null:b(a.minimum_threshold)};return Array.isArray(a.locations)&&(c.locations=a.locations.map(a=>({id:String(a.id??a.location_id??crypto.randomUUID()),name:String(a.name??a.location_name??""),code:"string"==typeof a.code?a.code:null,onHandQuantity:b(a.onhand_qty??a.qty_onhand)}))),c}function f(a){return{id:String(a.id??a.batch_id??crypto.randomUUID()),itemId:String(a.item_id??a.id??""),itemName:String(a.item_name??a.name??""),lotNumber:"string"==typeof a.lot_number?a.lot_number:null,expiryDate:"string"==typeof a.expiry_date?a.expiry_date:null,daysUntilExpiry:null===a.days_until_expiry||void 0===a.days_until_expiry?null:b(a.days_until_expiry),locationId:"string"==typeof a.location_id?a.location_id:null,locationName:"string"==typeof a.location_name?a.location_name:null}}function g(a){let b=a.address,d=null;return"string"==typeof b?d=b:b&&"object"==typeof b&&(d=("string"==typeof b.formatted?String(b.formatted):"string"==typeof b.label?String(b.label):null)??JSON.stringify(b)),{id:String(a.id),name:String(a.name??""),code:"string"==typeof a.code?a.code:null,type:"string"==typeof a.type?a.type:null,address:d,active:c(a.active,!0),createdAt:"string"==typeof a.created_at?a.created_at:null,updatedAt:"string"==typeof a.updated_at?a.updated_at:null}}function h(a){return{id:Number.parseInt(String(a.id),10),name:String(a.name??""),description:"string"==typeof a.description?a.description:null,website:"string"==typeof a.website?a.website:null,isActive:c(a.is_active,!0),createdAt:"string"==typeof a.created_at?a.created_at:null,updatedAt:"string"==typeof a.updated_at?a.updated_at:null}}function i(a){return{id:String(a.id),itemId:String(a.item_id??""),itemName:String(a.item_name??a.name??""),locationId:"string"==typeof a.location_id?a.location_id:null,locationName:"string"==typeof a.location_name?a.location_name:null,qty:b(a.qty??a.quantity??0),refType:"string"==typeof a.ref_type?a.ref_type:null,providerOrgId:null===a.provider_org_id||void 0===a.provider_org_id?null:Number.parseInt(String(a.provider_org_id),10),providerOrgName:"string"==typeof a.provider_org_name?a.provider_org_name:null,notes:"string"==typeof a.notes?a.notes:null,unitCost:null===a.unit_cost||void 0===a.unit_cost?null:b(a.unit_cost),createdAt:String(a.created_at??new Date().toISOString()),createdBy:"string"==typeof a.created_by?a.created_by:null,batchId:"string"==typeof a.batch_id?a.batch_id:null,lotNumber:"string"==typeof a.lot_number?a.lot_number:null,expiryDate:"string"==typeof a.expiry_date?a.expiry_date:null}}async function j(a,b,c){let{data:d,error:e}=await a.schema("inventory").rpc(b,c??{});if(e)throw e;return d?Array.isArray(d)?d:[d]:[]}async function k(a){let{data:b,error:c}=await a.schema("inventory").from("v_items_with_balances").select("*").order("name");if(c)throw c;return(b??[]).map(d)}async function l(a){let{data:b,error:c}=await a.schema("inventory").from("v_low_stock").select("*").order("onhand_qty",{ascending:!0});if(c)throw c;return(b??[]).map(e)}async function m(a,b=30){return(await j(a,"get_expiring_items",{days_ahead:b})).map(f)}async function n(a){let{data:b,error:c}=await a.schema("inventory").from("locations").select("*").order("name");if(c)throw c;return(b??[]).map(g)}async function o(a){let{data:b,error:c}=await a.schema("core").from("organizations").select("*").order("is_active",{ascending:!1}).order("name");if(c)throw c;return(b??[]).map(h)}async function p(a,{startDate:b,endDate:c,organizationId:d,sourceType:e,locationId:f,itemId:g,search:h,limit:j}={}){let k=Math.min(Math.max(Number(j??100),1),500),l=a.schema("inventory").from("v_transactions_with_org").select("*").eq("reason_code","receipt").order("created_at",{ascending:!1}).limit(k);if(b&&(l=l.gte("created_at",b)),c&&(l=l.lte("created_at",c)),d){let a=Number.parseInt(d,10);Number.isNaN(a)||(l=l.eq("provider_org_id",a))}if(e&&(l=l.eq("ref_type",e)),f&&(l=l.eq("location_id",f)),g&&(l=l.eq("item_id",g)),h){let a=h.trim();if(a.length>0){let b=`%${a}%`;l=l.or(`item_name.ilike.${b},provider_org_name.ilike.${b},notes.ilike.${b},location_name.ilike.${b}`)}}let{data:m,error:n}=await l;if(n)throw n;return(m??[]).map(i)}async function q(a,b){if(!b)return null;let{data:c,error:d}=await a.schema("inventory").from("v_transactions_with_org").select("*").eq("id",b).maybeSingle();if(d)throw d;return c?i(c):null}async function r(a){let[b,c,d,e]=await Promise.all([k(a),l(a),m(a,30),p(a,{limit:10})]);return{summary:{totalItems:b.length,activeItems:b.filter(a=>a.active).length,lowStockCount:c.length,expiringCount:d.filter(a=>(a.daysUntilExpiry??1/0)<=7).length,totalOnHand:b.reduce((a,b)=>a+b.onHandQuantity,0)},lowStockItems:c,expiringItems:d,recentReceipts:e.slice(0,10)}}async function s(a){let[b,c,d,e,f]=await Promise.all([k(a),r(a),n(a),o(a),p(a,{limit:50})]),g=Array.from(new Set(b.map(a=>a.category).filter(a=>"string"==typeof a&&a.length>0))).sort((a,b)=>a.localeCompare(b));return{items:b,dashboard:c,locations:d,organizations:e,receipts:f,categories:g}}a.s(["fetchInventoryBootstrap",()=>s,"fetchInventoryItems",()=>k,"fetchInventoryReceiptById",()=>q])},23318,a=>{"use strict";var b=a.i(7997);a.i(70396);var c=a.i(73727),d=a.i(9919),e=a.i(65108);function f(a){if(null==a)return null;if("number"==typeof a)return Number.isFinite(a)?a:null;if("string"==typeof a){let b=Number.parseFloat(a);return Number.isFinite(b)?b:null}return"bigint"==typeof a?Number(a):null}async function g(a){let b=a.schema("donations"),[c,d]=await Promise.all([b.from("catalog_items").select("*").order("priority",{ascending:!0}).order("title",{ascending:!0}),b.from("catalog_item_metrics").select("*")]);if(c.error)throw c.error;if(d.error)throw d.error;let e=new Map;for(let a of d.data??[]){let b="string"==typeof a.catalog_item_id?a.catalog_item_id:null;b&&e.set(b,{currentStock:f(a.current_stock),targetBuffer:f(a.target_buffer),distributedLast30Days:f(a.distributed_last_30_days),distributedLast365Days:f(a.distributed_last_365_days),inventoryItemName:"string"==typeof a.inventory_item_name?a.inventory_item_name:null,inventoryItemCategory:"string"==typeof a.inventory_item_category?a.inventory_item_category:null,inventoryUnitType:"string"==typeof a.unit_type?a.unit_type:null})}return(c.data??[]).map(a=>{let b=String(a.id),c=e.get(b)??{currentStock:null,targetBuffer:null,distributedLast30Days:null,distributedLast365Days:null,inventoryItemName:null,inventoryItemCategory:null,inventoryUnitType:null},d="string"==typeof a.inventory_item_id?a.inventory_item_id:"";if(!d)throw Error("Catalogue item is missing required inventory mapping.");return{id:b,slug:String(a.slug??""),title:String(a.title??""),shortDescription:"string"==typeof a.short_description?a.short_description:null,longDescription:"string"==typeof a.long_description?a.long_description:null,category:"string"==typeof a.category?a.category:null,inventoryItemId:d,unitCostCents:f(a.unit_cost_cents),currency:"string"==typeof a.currency?a.currency:"CAD",defaultQuantity:f(a.default_quantity)??1,priority:f(a.priority)??100,targetBuffer:f(a.target_buffer),imageUrl:"string"==typeof a.image_url?a.image_url:null,stripePriceId:"string"==typeof a.stripe_price_id?a.stripe_price_id:null,isActive:!1!==a.is_active,metrics:c}})}var h=a.i(83667),i=a.i(49701),j=a.i(19637),k=a.i(38904),l=a.i(55583),m=a.i(43562),n=a.i(70444),o=a.i(58774),p=a.i(39138);let q=["CAD","USD"];function r({item:a,inventoryItems:c,variant:d="edit"}){let e=a?.inventoryItemId??"",f=a?.metrics;return(0,b.jsxs)("form",{action:i.saveCatalogItem,className:"space-y-4 rounded-2xl border border-outline/15 bg-surface p-4 shadow-level-1",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("p",{className:"text-xs font-semibold uppercase tracking-wide text-primary",children:"create"===d?"New catalogue item":a?.category??"Catalogue item"}),(0,b.jsx)("h3",{className:"text-lg font-semibold text-on-surface",children:a?.title??"Add a new donation option"}),(0,b.jsx)("p",{className:"text-sm text-on-surface/70",children:"Map this item to inventory so live stock and distribution metrics can flow to the marketing site."})]}),a?(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,b.jsx)(j.Badge,{variant:a.isActive?"outline":"secondary",children:a.isActive?"Active":"Hidden"}),(0,b.jsxs)(j.Badge,{variant:"secondary",children:[f?.currentStock??0," on hand",f?.targetBuffer?` / ${f.targetBuffer} target`:null]})]}):null]}),(0,b.jsx)("input",{type:"hidden",name:"id",defaultValue:a?.id??""}),(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(m.Label,{htmlFor:`title-${a?.id??"new"}`,children:"Title"}),(0,b.jsx)(l.Input,{id:`title-${a?.id??"new"}`,name:"title",defaultValue:a?.title,placeholder:"Warm winter kit",required:!0})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(m.Label,{htmlFor:`slug-${a?.id??"new"}`,children:"Slug"}),(0,b.jsx)(l.Input,{id:`slug-${a?.id??"new"}`,name:"slug",defaultValue:a?.slug,placeholder:"warm-winter-kit"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(m.Label,{htmlFor:`category-${a?.id??"new"}`,children:"Category"}),(0,b.jsx)(l.Input,{id:`category-${a?.id??"new"}`,name:"category",defaultValue:a?.category??"",placeholder:"Warmth, Hygiene, Nutrition"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(m.Label,{htmlFor:`inventory-${a?.id??"new"}`,children:"Inventory item"}),(0,b.jsxs)(n.Select,{name:"inventory_item_id",defaultValue:e||void 0,required:!0,children:[(0,b.jsx)(n.SelectTrigger,{id:`inventory-${a?.id??"new"}`,children:(0,b.jsx)(n.SelectValue,{placeholder:"Select an inventory item"})}),(0,b.jsx)(n.SelectContent,{children:c.map(a=>(0,b.jsxs)(n.SelectItem,{value:a.id,children:[a.name," ",a.unitType?`\xb7 ${a.unitType}`:""]},a.id))})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(m.Label,{htmlFor:`unit-cost-${a?.id??"new"}`,children:"Typical cost (dollars)"}),(0,b.jsx)(l.Input,{id:`unit-cost-${a?.id??"new"}`,name:"unit_cost",type:"number",min:"0",step:"0.01",inputMode:"decimal",defaultValue:a?.unitCostCents?(a.unitCostCents/100).toFixed(2):"",placeholder:"15.00"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(m.Label,{htmlFor:`currency-${a?.id??"new"}`,children:"Currency"}),(0,b.jsxs)(n.Select,{name:"currency",defaultValue:a?.currency??"CAD",children:[(0,b.jsx)(n.SelectTrigger,{id:`currency-${a?.id??"new"}`,children:(0,b.jsx)(n.SelectValue,{})}),(0,b.jsx)(n.SelectContent,{children:q.map(a=>(0,b.jsx)(n.SelectItem,{value:a,children:a},a))})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(m.Label,{htmlFor:`default-qty-${a?.id??"new"}`,children:"Default quantity"}),(0,b.jsx)(l.Input,{id:`default-qty-${a?.id??"new"}`,name:"default_quantity",type:"number",min:"1",defaultValue:a?.defaultQuantity??1})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(m.Label,{htmlFor:`priority-${a?.id??"new"}`,children:"Display priority (lower shows first)"}),(0,b.jsx)(l.Input,{id:`priority-${a?.id??"new"}`,name:"priority",type:"number",min:"1",defaultValue:a?.priority??100})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(m.Label,{htmlFor:`target-${a?.id??"new"}`,children:"Target buffer"}),(0,b.jsx)(l.Input,{id:`target-${a?.id??"new"}`,name:"target_buffer",type:"number",min:"0",defaultValue:a?.targetBuffer??"",placeholder:"Optional override"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(m.Label,{htmlFor:`image-${a?.id??"new"}`,children:"Image URL (optional)"}),(0,b.jsx)(l.Input,{id:`image-${a?.id??"new"}`,name:"image_url",type:"url",defaultValue:a?.imageUrl??"",placeholder:"https://example.com/image.jpg"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(m.Label,{htmlFor:`stripe-${a?.id??"new"}`,children:"Stripe price ID (optional)"}),(0,b.jsx)(l.Input,{id:`stripe-${a?.id??"new"}`,name:"stripe_price_id",defaultValue:a?.stripePriceId??"",placeholder:"price_123"})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(m.Label,{htmlFor:`short-${a?.id??"new"}`,children:"Short description"}),(0,b.jsx)(l.Input,{id:`short-${a?.id??"new"}`,name:"short_description",defaultValue:a?.shortDescription??"",placeholder:"One sentence for the public catalogue"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(m.Label,{htmlFor:`long-${a?.id??"new"}`,children:"Long description (optional)"}),(0,b.jsx)(o.Textarea,{id:`long-${a?.id??"new"}`,name:"long_description",defaultValue:a?.longDescription??"",placeholder:"Context for staff or future UI.",rows:3})]}),(0,b.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[(0,b.jsxs)("label",{className:"inline-flex items-center gap-2 text-sm font-medium text-on-surface",children:[(0,b.jsx)(l.Input,{type:"checkbox",name:"is_active",className:"h-4 w-4",defaultChecked:a?.isActive??!0}),"Visible on marketing site"]}),(0,b.jsx)(k.Button,{type:"submit",children:"create"===d?"Add item":"Save changes"})]}),a?(0,b.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-2 border-t border-outline/10 pt-3 text-xs text-on-surface/70",children:[(0,b.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,b.jsxs)(j.Badge,{variant:"outline",children:["Slug: ",a.slug]}),f?.inventoryItemName?(0,b.jsxs)(j.Badge,{variant:"outline",children:["Inventory: ",f.inventoryItemName,f.inventoryUnitType?` \xb7 ${f.inventoryUnitType}`:""]}):(0,b.jsx)(j.Badge,{variant:"secondary",children:"No inventory link"})]}),(0,b.jsxs)("form",{action:i.toggleCatalogItem,children:[(0,b.jsx)("input",{type:"hidden",name:"id",value:a.id}),(0,b.jsx)("input",{type:"hidden",name:"next_state",value:a.isActive?"deactivate":"activate"}),(0,b.jsx)(k.Button,{variant:"ghost",size:"sm",type:"submit",className:(0,p.cn)("px-3",a.isActive?"text-destructive":"text-primary"),children:a.isActive?"Hide from marketing":"Activate item"})]})]}):null]})}function s({catalog:a,inventoryItems:c}){let d=a.filter(a=>a.isActive),e=a.filter(a=>!a.isActive),f=new Set(a.map(a=>a.inventoryItemId)),g=c.filter(a=>a.active&&!f.has(a.id));return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"grid gap-6 lg:grid-cols-[2fr,1fr]",children:[(0,b.jsx)(r,{inventoryItems:c,variant:"create"}),(0,b.jsxs)("div",{className:"rounded-2xl border border-outline/15 bg-surface px-4 py-3 shadow-level-1",children:[(0,b.jsx)("h4",{className:"text-sm font-semibold text-on-surface",children:"Live stats"}),(0,b.jsxs)("p",{className:"mt-1 text-sm text-on-surface/70",children:["The marketing page reads from ",(0,b.jsx)("code",{children:"portal.donation_catalog_public"}),". Data updates after each save and cache revalidation."]}),(0,b.jsxs)("div",{className:"mt-3 grid grid-cols-2 gap-3 text-sm",children:[(0,b.jsxs)("div",{className:"rounded-xl bg-surface-container-low p-3",children:[(0,b.jsx)("p",{className:"text-xs font-semibold uppercase tracking-wide text-on-surface/60",children:"Active items"}),(0,b.jsx)("p",{className:"text-xl font-semibold text-on-surface",children:d.length})]}),(0,b.jsxs)("div",{className:"rounded-xl bg-surface-container-low p-3",children:[(0,b.jsx)("p",{className:"text-xs font-semibold uppercase tracking-wide text-on-surface/60",children:"Hidden items"}),(0,b.jsx)("p",{className:"text-xl font-semibold text-on-surface",children:e.length})]})]}),(0,b.jsxs)("div",{className:"mt-4 rounded-xl bg-surface-container-low p-3",children:[(0,b.jsx)("p",{className:"text-xs font-semibold uppercase tracking-wide text-on-surface/60",children:"Import from inventory"}),0===g.length?(0,b.jsx)("p",{className:"mt-2 text-xs text-on-surface/70",children:"All active inventory items are already mapped."}):(0,b.jsxs)("form",{action:i.importInventoryItem,className:"mt-2 space-y-2",children:[(0,b.jsxs)(n.Select,{name:"inventory_item_id",required:!0,children:[(0,b.jsx)(n.SelectTrigger,{children:(0,b.jsx)(n.SelectValue,{placeholder:"Select an inventory item"})}),(0,b.jsx)(n.SelectContent,{children:g.map(a=>(0,b.jsxs)(n.SelectItem,{value:a.id,children:[a.name," ",a.unitType?`\xb7 ${a.unitType}`:""," ",a.category?`(${a.category})`:""]},a.id))})]}),(0,b.jsx)("p",{className:"text-xs text-on-surface/60",children:"Imports name, category, target buffer, and unit cost. You can edit details after import."}),(0,b.jsx)(k.Button,{type:"submit",size:"sm",className:"w-full",children:"Import selected item"})]})]})]})]}),(0,b.jsx)("div",{className:"grid gap-5 md:grid-cols-2",children:0===a.length?(0,b.jsx)("div",{className:"rounded-2xl border border-outline/15 bg-surface p-4 text-sm text-on-surface/70 shadow-level-1",children:"No catalogue items yet. Add one above to get started."}):a.map(a=>(0,b.jsx)(r,{item:a,inventoryItems:c},a.id))})]})}async function t(){let a=await (0,d.createSupabaseRSCClient)(),f=await (0,e.loadPortalAccess)(a);f&&f.iharcRoles.includes("iharc_admin")||(0,c.redirect)("/admin");let[i,j]=await Promise.all([g(a),(0,h.fetchInventoryItems)(a).catch(()=>[])]);return(0,b.jsxs)("div",{className:"page-shell page-stack",children:[(0,b.jsxs)("header",{className:"flex flex-col gap-space-xs",children:[(0,b.jsx)("p",{className:"text-label-sm font-medium uppercase text-muted-foreground",children:"Donations"}),(0,b.jsx)("h1",{className:"text-title-lg text-on-surface sm:text-headline-sm",children:"Donation catalogue"}),(0,b.jsx)("p",{className:"max-w-3xl text-body-md text-muted-foreground sm:text-body-lg",children:"Manage the public donation catalogue, link items to inventory, and keep live metrics in sync with the marketing site. All payment logic stays inside STEVI and Supabase."})]}),(0,b.jsx)(s,{catalog:i,inventoryItems:j})]})}a.s(["default",()=>t,"dynamic",0,"force-dynamic"],23318)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__cea374bd._.js.map