module.exports=[63331,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(7554),e=a.i(50104),f=a.i(24050),g=a.i(77192),h=a.i(30553),i=a.i(7827),j=a.i(25152),k=a.i(92843),l="Tabs",[m,n]=(0,e.createContextScope)(l,[f.createRovingFocusGroupScope]),o=(0,f.createRovingFocusGroupScope)(),[p,q]=m(l),r=c.forwardRef((a,c)=>{let{__scopeTabs:d,value:e,onValueChange:f,defaultValue:g,orientation:m="horizontal",dir:n,activationMode:o="automatic",...q}=a,r=(0,i.useDirection)(n),[s,t]=(0,j.useControllableState)({prop:e,onChange:f,defaultProp:g??"",caller:l});return(0,b.jsx)(p,{scope:d,baseId:(0,k.useId)(),value:s,onValueChange:t,orientation:m,dir:r,activationMode:o,children:(0,b.jsx)(h.Primitive.div,{dir:r,"data-orientation":m,...q,ref:c})})});r.displayName=l;var s="TabsList",t=c.forwardRef((a,c)=>{let{__scopeTabs:d,loop:e=!0,...g}=a,i=q(s,d),j=o(d);return(0,b.jsx)(f.Root,{asChild:!0,...j,orientation:i.orientation,dir:i.dir,loop:e,children:(0,b.jsx)(h.Primitive.div,{role:"tablist","aria-orientation":i.orientation,...g,ref:c})})});t.displayName=s;var u="TabsTrigger",v=c.forwardRef((a,c)=>{let{__scopeTabs:e,value:g,disabled:i=!1,...j}=a,k=q(u,e),l=o(e),m=y(k.baseId,g),n=z(k.baseId,g),p=g===k.value;return(0,b.jsx)(f.Item,{asChild:!0,...l,focusable:!i,active:p,children:(0,b.jsx)(h.Primitive.button,{type:"button",role:"tab","aria-selected":p,"aria-controls":n,"data-state":p?"active":"inactive","data-disabled":i?"":void 0,disabled:i,id:m,...j,ref:c,onMouseDown:(0,d.composeEventHandlers)(a.onMouseDown,a=>{i||0!==a.button||!1!==a.ctrlKey?a.preventDefault():k.onValueChange(g)}),onKeyDown:(0,d.composeEventHandlers)(a.onKeyDown,a=>{[" ","Enter"].includes(a.key)&&k.onValueChange(g)}),onFocus:(0,d.composeEventHandlers)(a.onFocus,()=>{let a="manual"!==k.activationMode;p||i||!a||k.onValueChange(g)})})})});v.displayName=u;var w="TabsContent",x=c.forwardRef((a,d)=>{let{__scopeTabs:e,value:f,forceMount:i,children:j,...k}=a,l=q(w,e),m=y(l.baseId,f),n=z(l.baseId,f),o=f===l.value,p=c.useRef(o);return c.useEffect(()=>{let a=requestAnimationFrame(()=>p.current=!1);return()=>cancelAnimationFrame(a)},[]),(0,b.jsx)(g.Presence,{present:i||o,children:({present:c})=>(0,b.jsx)(h.Primitive.div,{"data-state":o?"active":"inactive","data-orientation":l.orientation,role:"tabpanel","aria-labelledby":m,hidden:!c,id:n,tabIndex:0,...k,ref:d,style:{...a.style,animationDuration:p.current?"0s":void 0},children:c&&j})})});function y(a,b){return`${a}-trigger-${b}`}function z(a,b){return`${a}-content-${b}`}x.displayName=w;var A=a.i(68114);let B=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)(t,{ref:d,className:(0,A.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-space-2xs text-muted-foreground",a),...c}));B.displayName=t.displayName;let C=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)(v,{ref:d,className:(0,A.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-space-sm py-space-xs text-body-md font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",a),...c}));C.displayName=v.displayName;let D=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)(x,{ref:d,className:(0,A.cn)("mt-space-xs ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...c}));D.displayName=x.displayName;var E=a.i(91119),F=a.i(6015);function G({dashboard:a}){return(0,b.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 xl:grid-cols-4",children:[(0,b.jsx)(H,{label:"Items tracked",value:a.summary.totalItems.toLocaleString()}),(0,b.jsx)(H,{label:"Active items",value:a.summary.activeItems.toLocaleString()}),(0,b.jsx)(H,{label:"Low stock alerts",value:a.summary.lowStockCount.toLocaleString(),accent:!0}),(0,b.jsx)(H,{label:"Units on hand",value:a.summary.totalOnHand.toLocaleString()})]}),(0,b.jsxs)("div",{className:"grid gap-6 lg:grid-cols-2",children:[(0,b.jsxs)(E.Card,{className:"h-full",children:[(0,b.jsx)(E.CardHeader,{children:(0,b.jsx)(E.CardTitle,{className:"text-body-lg font-semibold",children:"Low stock items"})}),(0,b.jsx)(E.CardContent,{className:"px-0",children:0===a.lowStockItems.length?(0,b.jsx)(I,{message:"All items are currently above their minimum thresholds."}):(0,b.jsxs)(F.Table,{children:[(0,b.jsx)(F.TableHeader,{children:(0,b.jsxs)(F.TableRow,{children:[(0,b.jsx)(F.TableHead,{children:"Item"}),(0,b.jsx)(F.TableHead,{children:"Category"}),(0,b.jsx)(F.TableHead,{className:"text-right",children:"On hand"}),(0,b.jsx)(F.TableHead,{className:"text-right",children:"Threshold"})]})}),(0,b.jsx)(F.TableBody,{children:a.lowStockItems.slice(0,8).map(a=>(0,b.jsxs)(F.TableRow,{children:[(0,b.jsx)(F.TableCell,{className:"font-medium",children:a.name}),(0,b.jsx)(F.TableCell,{children:a.category??"Uncategorised"}),(0,b.jsx)(F.TableCell,{className:"text-right",children:a.onHandQuantity.toLocaleString()}),(0,b.jsx)(F.TableCell,{className:"text-right",children:null===a.minimumThreshold?"—":a.minimumThreshold.toLocaleString()})]},a.id))})]})})]}),(0,b.jsxs)(E.Card,{className:"h-full",children:[(0,b.jsx)(E.CardHeader,{children:(0,b.jsx)(E.CardTitle,{className:"text-body-lg font-semibold",children:"Expiring soon"})}),(0,b.jsx)(E.CardContent,{className:"px-0",children:0===a.expiringItems.length?(0,b.jsx)(I,{message:"No batches are approaching their expiry window."}):(0,b.jsxs)(F.Table,{children:[(0,b.jsx)(F.TableHeader,{children:(0,b.jsxs)(F.TableRow,{children:[(0,b.jsx)(F.TableHead,{children:"Item"}),(0,b.jsx)(F.TableHead,{children:"Lot"}),(0,b.jsx)(F.TableHead,{children:"Location"}),(0,b.jsx)(F.TableHead,{className:"text-right",children:"Days"})]})}),(0,b.jsx)(F.TableBody,{children:a.expiringItems.slice(0,8).map(a=>(0,b.jsxs)(F.TableRow,{children:[(0,b.jsx)(F.TableCell,{className:"font-medium",children:a.itemName}),(0,b.jsx)(F.TableCell,{children:a.lotNumber??"—"}),(0,b.jsx)(F.TableCell,{children:a.locationName??"—"}),(0,b.jsx)(F.TableCell,{className:"text-right",children:null===a.daysUntilExpiry?"—":a.daysUntilExpiry.toLocaleString()})]},a.id))})]})})]})]}),(0,b.jsxs)(E.Card,{children:[(0,b.jsx)(E.CardHeader,{children:(0,b.jsx)(E.CardTitle,{className:"text-body-lg font-semibold",children:"Recent receipts"})}),(0,b.jsx)(E.CardContent,{className:"px-0",children:0===a.recentReceipts.length?(0,b.jsx)(I,{message:"No stock receipts recorded in the last few days."}):(0,b.jsxs)(F.Table,{children:[(0,b.jsx)(F.TableHeader,{children:(0,b.jsxs)(F.TableRow,{children:[(0,b.jsx)(F.TableHead,{children:"Item"}),(0,b.jsx)(F.TableHead,{children:"Location"}),(0,b.jsx)(F.TableHead,{children:"Source"}),(0,b.jsx)(F.TableHead,{className:"text-right",children:"Quantity"}),(0,b.jsx)(F.TableHead,{className:"text-right",children:"Unit cost"}),(0,b.jsx)(F.TableHead,{className:"text-right",children:"Received"})]})}),(0,b.jsx)(F.TableBody,{children:a.recentReceipts.slice(0,10).map(a=>(0,b.jsxs)(F.TableRow,{children:[(0,b.jsx)(F.TableCell,{className:"font-medium",children:a.itemName}),(0,b.jsx)(F.TableCell,{children:a.locationName??"—"}),(0,b.jsx)(F.TableCell,{children:a.providerOrgName??a.refType??"—"}),(0,b.jsx)(F.TableCell,{className:"text-right",children:a.qty.toLocaleString()}),(0,b.jsx)(F.TableCell,{className:"text-right",children:null===a.unitCost?"—":`$${a.unitCost.toFixed(2)}`}),(0,b.jsx)(F.TableCell,{className:"text-right",children:new Date(a.createdAt).toLocaleDateString()})]},a.id))})]})})]})]})}function H({label:a,value:c,accent:d=!1}){return(0,b.jsxs)(E.Card,{className:d?"border-destructive text-destructive-foreground state-layer-color-error state-layer-hover":"",children:[(0,b.jsx)(E.CardHeader,{children:(0,b.jsx)(E.CardTitle,{className:"text-label-sm font-medium uppercase text-muted-foreground",children:a})}),(0,b.jsx)(E.CardContent,{children:(0,b.jsx)("p",{className:"text-headline-sm font-semibold text-on-surface",children:c})})]})}function I({message:a}){return(0,b.jsx)("div",{className:"flex flex-col items-center justify-center gap-2 p-6 text-center text-body-md text-muted-foreground",children:(0,b.jsx)("p",{children:a})})}var J=a.i(50944),K=a.i(99570),L=a.i(14574),M=a.i(66718),N=a.i(70430),O=a.i(29246),P=a.i(78125),Q=a.i(15055),R=a.i(80701),S=a.i(5050),T=(0,S.createServerReference)("40fb42223fbaabe80e63bff0a00e0c25fc6ca0c331",S.callServer,void 0,S.findSourceMapURL,"adjustInventoryStockAction"),U=(0,S.createServerReference)("40108f8f43fea9ee4608a53636c7e5b4320d353870",S.callServer,void 0,S.findSourceMapURL,"bulkReceiveInventoryStockAction"),V=(0,S.createServerReference)("400bce6c909697364ba29c68866355de13b09a5677",S.callServer,void 0,S.findSourceMapURL,"createInventoryItemAction"),W=(0,S.createServerReference)("40a3769bbe61042790510d7f50d8ece8a924cd4c39",S.callServer,void 0,S.findSourceMapURL,"deleteInventoryItemAction"),X=(0,S.createServerReference)("40851b3784f78e9ef426e0d09453fef736e8732c6a",S.callServer,void 0,S.findSourceMapURL,"receiveInventoryStockAction"),Y=(0,S.createServerReference)("40ffa48111ad0c4a3013e10d2da655d8e2d303b4e1",S.callServer,void 0,S.findSourceMapURL,"toggleInventoryItemStatusAction"),Z=(0,S.createServerReference)("400b464e5b0991def1b3b2300bc775c284e2b96d8f",S.callServer,void 0,S.findSourceMapURL,"transferInventoryStockAction"),$=(0,S.createServerReference)("401df522679bb5cd394bde463e79e3f995ce6a5efc",S.callServer,void 0,S.findSourceMapURL,"updateInventoryItemAction");let _=new Date().toISOString().slice(0,10);function aa({items:a,locations:d,organizations:e,categories:f,actorProfileId:g}){let h=(0,J.useRouter)(),{toast:i}=(0,P.useToast)(),[j,k]=(0,c.useState)(!1),[l,m]=(0,c.useState)(null),[n,o]=(0,c.useState)(null),[p,q]=(0,c.useState)(null),[r,s]=(0,c.useState)(null),[t,u]=(0,c.useState)(!1),[v,w]=(0,c.useTransition)(),x=(0,c.useMemo)(()=>Array.from(new Set(f)).sort((a,b)=>a.localeCompare(b)),[f]),y=(0,c.useMemo)(()=>e.filter(a=>a.isActive),[e]),z=(a,b,c)=>{a.success?(c&&c(),i({title:"Inventory updated",description:b}),w(()=>h.refresh())):i({variant:"destructive",title:"Inventory error",description:a.error??"Action failed."})},A=async a=>{a.set("actor_profile_id",g),z(await V(a),"Item created successfully.",()=>k(!1))},B=async a=>{a.set("actor_profile_id",g),z(await $(a),"Item updated.",()=>m(null))},C=async a=>{a.set("actor_profile_id",g),z(await X(a),"Stock received.",()=>o(null))},D=async a=>{a.set("actor_profile_id",g),z(await Z(a),"Stock transferred.",()=>q(null))},G=async a=>{a.set("actor_profile_id",g),z(await T(a),"Adjustment applied.",()=>s(null))},H=async(a,b)=>{let c=new FormData;c.set("actor_profile_id",g),c.set("item_id",a.id),c.set("active",String(b)),z(await Y(c),b?"Item activated.":"Item deactivated.")},I=async a=>{let b=new FormData;b.set("actor_profile_id",g),b.set("item_id",a.id),z(await W(b),"Item deleted.")},M=async a=>{let b;a.set("actor_profile_id",g);let c=a.get("items_json");if("string"!=typeof c)return void i({title:"Bulk receipt error",variant:"destructive",description:"Bulk payload missing."});try{b=JSON.parse(c)}catch{i({title:"Bulk receipt error",variant:"destructive",description:"Bulk payload invalid JSON."});return}let d=new FormData;d.set("actor_profile_id",g),d.set("items",JSON.stringify(b)),z(await U(d),"Bulk receipt queued.",()=>u(!1))};return(0,b.jsxs)(E.Card,{className:"border-border/60",children:[(0,b.jsxs)(E.CardHeader,{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[(0,b.jsx)(E.CardTitle,{className:"text-title-sm font-semibold",children:"Inventory items"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)(L.Dialog,{open:t,onOpenChange:u,children:[(0,b.jsx)(L.DialogTrigger,{asChild:!0,children:(0,b.jsx)(K.Button,{variant:"outline",children:"Bulk receive"})}),(0,b.jsx)(ah,{isPending:v,onSubmit:M,actorProfileId:g,items:a,locations:d,organizations:y})]}),(0,b.jsxs)(L.Dialog,{open:j,onOpenChange:k,children:[(0,b.jsx)(L.DialogTrigger,{asChild:!0,children:(0,b.jsx)(K.Button,{children:"Create item"})}),(0,b.jsx)(ab,{title:"Create inventory item",actionLabel:"Create item",defaultValues:null,categories:x,locations:d,isPending:v,onSubmit:A,actorProfileId:g})]})]})]}),(0,b.jsx)(E.CardContent,{className:"overflow-x-auto",children:(0,b.jsxs)(F.Table,{children:[(0,b.jsx)(F.TableHeader,{children:(0,b.jsxs)(F.TableRow,{children:[(0,b.jsx)(F.TableHead,{children:"Item"}),(0,b.jsx)(F.TableHead,{children:"Category"}),(0,b.jsx)(F.TableHead,{children:"Unit"}),(0,b.jsx)(F.TableHead,{className:"text-right",children:"On hand"}),(0,b.jsx)(F.TableHead,{className:"text-right",children:"Threshold"}),(0,b.jsx)(F.TableHead,{className:"text-right",children:"Status"}),(0,b.jsx)(F.TableHead,{className:"text-right",children:"Actions"})]})}),(0,b.jsx)(F.TableBody,{children:a.map(a=>(0,b.jsxs)(F.TableRow,{className:a.active?void 0:"opacity-60",children:[(0,b.jsx)(F.TableCell,{className:"font-medium",children:a.name}),(0,b.jsx)(F.TableCell,{children:a.category??"—"}),(0,b.jsx)(F.TableCell,{children:a.unitType??"—"}),(0,b.jsx)(F.TableCell,{className:"text-right",children:a.onHandQuantity.toLocaleString()}),(0,b.jsx)(F.TableCell,{className:"text-right",children:null===a.minimumThreshold?"—":a.minimumThreshold.toLocaleString()}),(0,b.jsx)(F.TableCell,{className:"text-right",children:(0,b.jsx)("span",{className:a.active?"text-primary":"text-muted-foreground",children:a.active?"Active":"Inactive"})}),(0,b.jsxs)(F.TableCell,{className:"space-x-2 text-right",children:[(0,b.jsx)(K.Button,{size:"sm",variant:"outline",onClick:()=>o(a),children:"Receive"}),(0,b.jsx)(K.Button,{size:"sm",variant:"outline",onClick:()=>q(a),children:"Transfer"}),(0,b.jsx)(K.Button,{size:"sm",variant:"outline",onClick:()=>s(a),children:"Adjust"}),(0,b.jsx)(K.Button,{size:"sm",variant:"ghost",onClick:()=>m(a),children:"Edit"}),(0,b.jsx)(K.Button,{size:"sm",variant:"ghost",onClick:()=>H(a,!a.active),disabled:v,children:a.active?"Deactivate":"Activate"}),(0,b.jsx)(K.Button,{size:"sm",variant:"ghost",className:"text-destructive hover:text-destructive",onClick:()=>I(a),disabled:v,children:"Delete"})]})]},a.id))})]})}),(0,b.jsx)(E.CardFooter,{className:"text-label-sm text-muted-foreground",children:"Manage stock levels using receive, transfer, or adjust actions. Deactivating an item hides it from operational workflows without deleting historic transactions."}),(0,b.jsx)(ab,{title:"Edit inventory item",actionLabel:"Save changes",defaultValues:l,categories:x,locations:d,isPending:v,onSubmit:B,actorProfileId:g,open:null!==l,onOpenChange:a=>!a&&m(null)}),(0,b.jsx)(ad,{item:n,locations:d,organizations:y,isPending:v,onClose:()=>o(null),onSubmit:C,actorProfileId:g}),(0,b.jsx)(ae,{item:p,locations:d,isPending:v,onClose:()=>q(null),onSubmit:D,actorProfileId:g}),(0,b.jsx)(af,{item:r,locations:d,isPending:v,onClose:()=>s(null),onSubmit:G,actorProfileId:g})]})}function ab({title:a,actionLabel:c,defaultValues:d,categories:e,locations:f,onSubmit:g,actorProfileId:h,isPending:i,open:j,onOpenChange:k}){return(0,b.jsx)(L.Dialog,{open:j,onOpenChange:k,children:(0,b.jsxs)(L.DialogContent,{className:"max-w-xl",children:[(0,b.jsxs)(L.DialogHeader,{children:[(0,b.jsx)(L.DialogTitle,{children:a}),(0,b.jsx)(L.DialogDescription,{children:"Provide descriptive names and categories so outreach staff can find items quickly across locations."})]}),(0,b.jsxs)("form",{action:g,className:"space-y-4",children:[(0,b.jsx)("input",{type:"hidden",name:"actor_profile_id",value:h}),d?(0,b.jsx)("input",{type:"hidden",name:"item_id",value:d.id}):null,(0,b.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,b.jsx)(ac,{label:"Name",name:"name",defaultValue:d?.name,required:!0}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(N.Label,{htmlFor:"item_category",children:"Category"}),(0,b.jsx)("input",{list:"inventory-categories",name:"category",id:"item_category",defaultValue:d?.category??"",required:!0,className:"rounded-md border border-input bg-background px-3 py-2 text-body-md shadow-sm focus:outline-none"}),(0,b.jsx)("datalist",{id:"inventory-categories",children:e.map(a=>(0,b.jsx)("option",{value:a},a))})]}),(0,b.jsx)(ac,{label:"Unit type",name:"unit_type",defaultValue:d?.unitType,required:!0}),(0,b.jsx)(ac,{label:"Supplier",name:"supplier",defaultValue:d?.supplier??""})]}),(0,b.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,b.jsx)(ac,{label:"Minimum threshold",name:"minimum_threshold",type:"number",min:0,defaultValue:d?.minimumThreshold??"",placeholder:"Optional"}),(0,b.jsx)(ac,{label:"Unit cost",name:"cost_per_unit",type:"number",min:0,step:"0.01",defaultValue:d?.costPerUnit??"",placeholder:"Optional"})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(N.Label,{htmlFor:"item_description",children:"Description"}),(0,b.jsx)(O.Textarea,{id:"item_description",name:"description",rows:3,defaultValue:d?.description??"",placeholder:"Optional context for outreach staff"})]}),d?null:(0,b.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,b.jsx)(ac,{label:"Initial stock",name:"initial_stock",type:"number",min:0,placeholder:"0"}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(N.Label,{htmlFor:"initial_location_id",children:"Initial location"}),(0,b.jsxs)(R.Select,{name:"initial_location_id",children:[(0,b.jsx)(R.SelectTrigger,{id:"initial_location_id",children:(0,b.jsx)(R.SelectValue,{placeholder:"Select location"})}),(0,b.jsxs)(R.SelectContent,{children:[(0,b.jsx)(R.SelectItem,{value:"",children:"None"}),f.map(a=>(0,b.jsx)(R.SelectItem,{value:a.id,children:a.name},a.id))]})]}),(0,b.jsx)("p",{className:"text-label-sm text-muted-foreground",children:"Required if you record initial stock above zero."})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(Q.Checkbox,{id:"item_active",name:"active",defaultChecked:d?.active??!0}),(0,b.jsx)(N.Label,{htmlFor:"item_active",className:"text-body-md text-muted-foreground",children:"Item is active in operations"})]}),(0,b.jsx)(L.DialogFooter,{className:"pt-4",children:(0,b.jsx)(K.Button,{type:"submit",disabled:i,children:c})})]})]})})}function ac({label:a,name:c,defaultValue:d,placeholder:e,type:f="text",required:g,min:h,step:i}){return(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(N.Label,{htmlFor:c,children:a}),(0,b.jsx)(M.Input,{id:c,name:c,type:f,defaultValue:d??"",placeholder:e,required:g,min:h,step:i})]})}function ad({item:a,locations:c,organizations:d,onSubmit:e,onClose:f,actorProfileId:g,isPending:h}){return(0,b.jsx)(L.Dialog,{open:!!a,onOpenChange:a=>!a&&f(),children:(0,b.jsxs)(L.DialogContent,{className:"max-w-lg",children:[(0,b.jsxs)(L.DialogHeader,{children:[(0,b.jsx)(L.DialogTitle,{children:"Receive stock"}),(0,b.jsx)(L.DialogDescription,{children:"Record incoming donations or purchases. Quantities increase stock at the selected location."})]}),a?(0,b.jsxs)("form",{action:e,className:"space-y-4",children:[(0,b.jsx)("input",{type:"hidden",name:"actor_profile_id",value:g}),(0,b.jsx)("input",{type:"hidden",name:"item_id",value:a.id}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)(N.Label,{children:"Item"}),(0,b.jsx)("p",{className:"text-body-md font-medium text-on-surface",children:a.name})]}),(0,b.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,b.jsx)(ac,{label:"Quantity",name:"quantity",type:"number",min:0,required:!0,placeholder:"0"}),(0,b.jsx)(ac,{label:"Unit cost",name:"unit_cost",type:"number",min:0,step:"0.01",placeholder:"0.00"})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(N.Label,{htmlFor:"receive_location",children:"Location"}),(0,b.jsxs)(R.Select,{name:"location_id",required:!0,children:[(0,b.jsx)(R.SelectTrigger,{id:"receive_location",children:(0,b.jsx)(R.SelectValue,{placeholder:"Select location"})}),(0,b.jsx)(R.SelectContent,{children:c.map(a=>(0,b.jsx)(R.SelectItem,{value:a.id,children:a.name},a.id))})]})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(N.Label,{htmlFor:"receive_source",children:"Source type"}),(0,b.jsxs)(R.Select,{name:"source_type",children:[(0,b.jsx)(R.SelectTrigger,{id:"receive_source",children:(0,b.jsx)(R.SelectValue,{placeholder:"Select source"})}),(0,b.jsxs)(R.SelectContent,{children:[(0,b.jsx)(R.SelectItem,{value:"",children:"None"}),(0,b.jsx)(R.SelectItem,{value:"donation",children:"Donation"}),(0,b.jsx)(R.SelectItem,{value:"purchase",children:"Purchase"}),(0,b.jsx)(R.SelectItem,{value:"transfer_in",children:"Transfer in"}),(0,b.jsx)(R.SelectItem,{value:"adjustment",children:"Adjustment"})]})]})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(N.Label,{htmlFor:"provider_org",children:"Provider organisation"}),(0,b.jsxs)(R.Select,{name:"provider_org_id",children:[(0,b.jsx)(R.SelectTrigger,{id:"provider_org",children:(0,b.jsx)(R.SelectValue,{placeholder:"None"})}),(0,b.jsxs)(R.SelectContent,{children:[(0,b.jsx)(R.SelectItem,{value:"",children:"None"}),d.map(a=>(0,b.jsx)(R.SelectItem,{value:String(a.id),children:a.name},a.id))]})]})]}),(0,b.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,b.jsx)(ac,{label:"Lot number",name:"lot_number",placeholder:"Optional"}),(0,b.jsx)(ac,{label:"Expiry date",name:"expiry_date",type:"date",defaultValue:_})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(N.Label,{htmlFor:"receive_notes",children:"Notes"}),(0,b.jsx)(O.Textarea,{id:"receive_notes",name:"notes",rows:3,placeholder:"Optional context"})]}),(0,b.jsx)(L.DialogFooter,{className:"pt-4",children:(0,b.jsx)(K.Button,{type:"submit",disabled:h,children:"Record receipt"})})]}):null]})})}function ae({item:a,locations:c,onSubmit:d,onClose:e,actorProfileId:f,isPending:g}){return(0,b.jsx)(L.Dialog,{open:!!a,onOpenChange:a=>!a&&e(),children:(0,b.jsxs)(L.DialogContent,{className:"max-w-lg",children:[(0,b.jsxs)(L.DialogHeader,{children:[(0,b.jsx)(L.DialogTitle,{children:"Transfer stock"}),(0,b.jsx)(L.DialogDescription,{children:"Move stock from one location to another."})]}),a?(0,b.jsxs)("form",{action:d,className:"space-y-4",children:[(0,b.jsx)("input",{type:"hidden",name:"actor_profile_id",value:f}),(0,b.jsx)("input",{type:"hidden",name:"item_id",value:a.id}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)(N.Label,{children:"Item"}),(0,b.jsx)("p",{className:"text-body-md font-medium text-on-surface",children:a.name})]}),(0,b.jsx)(ac,{label:"Quantity",name:"quantity",type:"number",min:0,required:!0,placeholder:"0"}),(0,b.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,b.jsx)(ag,{label:"From",name:"from_location_id",locations:c,required:!0}),(0,b.jsx)(ag,{label:"To",name:"to_location_id",locations:c,required:!0})]}),(0,b.jsx)(ac,{label:"Notes",name:"notes",placeholder:"Optional"}),(0,b.jsx)(L.DialogFooter,{className:"pt-4",children:(0,b.jsx)(K.Button,{type:"submit",disabled:g,children:"Transfer"})})]}):null]})})}function af({item:a,locations:c,onSubmit:d,onClose:e,actorProfileId:f,isPending:g}){return(0,b.jsx)(L.Dialog,{open:!!a,onOpenChange:a=>!a&&e(),children:(0,b.jsxs)(L.DialogContent,{className:"max-w-lg",children:[(0,b.jsxs)(L.DialogHeader,{children:[(0,b.jsx)(L.DialogTitle,{children:"Adjust stock"}),(0,b.jsx)(L.DialogDescription,{children:"Apply corrections for damaged or counted stock."})]}),a?(0,b.jsxs)("form",{action:d,className:"space-y-4",children:[(0,b.jsx)("input",{type:"hidden",name:"actor_profile_id",value:f}),(0,b.jsx)("input",{type:"hidden",name:"item_id",value:a.id}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)(N.Label,{children:"Item"}),(0,b.jsx)("p",{className:"text-body-md font-medium text-on-surface",children:a.name})]}),(0,b.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,b.jsx)(ag,{label:"Location",name:"location_id",locations:c,required:!0}),(0,b.jsx)(ac,{label:"Quantity adjustment",name:"quantity_delta",type:"number",placeholder:"Use negative numbers for reductions",required:!0})]}),(0,b.jsx)(ac,{label:"Reason",name:"reason",placeholder:"e.g., Damaged during transit",required:!0}),(0,b.jsx)(ac,{label:"Notes",name:"notes",placeholder:"Optional"}),(0,b.jsx)(L.DialogFooter,{className:"pt-4",children:(0,b.jsx)(K.Button,{type:"submit",disabled:g,children:"Apply adjustment"})})]}):null]})})}function ag({label:a,name:c,locations:d,required:e}){return(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(N.Label,{htmlFor:c,children:a}),(0,b.jsxs)(R.Select,{name:c,required:e,children:[(0,b.jsx)(R.SelectTrigger,{id:c,children:(0,b.jsx)(R.SelectValue,{placeholder:"Select location"})}),(0,b.jsx)(R.SelectContent,{children:d.map(a=>(0,b.jsx)(R.SelectItem,{value:a.id,children:a.name},a.id))})]})]})}function ah({isPending:a,onSubmit:c,actorProfileId:d,items:e,locations:f,organizations:g}){return(0,b.jsxs)(L.DialogContent,{className:"max-w-2xl",children:[(0,b.jsxs)(L.DialogHeader,{children:[(0,b.jsx)(L.DialogTitle,{children:"Bulk receive stock"}),(0,b.jsx)(L.DialogDescription,{children:"Upload multiple receipts at once by pasting JSON payloads. Generated templates appear below to help format data quickly."})]}),(0,b.jsxs)("form",{action:c,className:"space-y-4",children:[(0,b.jsx)("input",{type:"hidden",name:"actor_profile_id",value:d}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(N.Label,{htmlFor:"bulk_items_json",children:"Receipts JSON"}),(0,b.jsx)(O.Textarea,{id:"bulk_items_json",name:"items_json",rows:8,className:"font-mono text-label-sm",placeholder:'{"items":[{"itemId":"...","quantity":10,"locationId":"..."}]}',required:!0}),(0,b.jsxs)("p",{className:"text-label-sm text-muted-foreground",children:["Include ",(0,b.jsx)("code",{children:"itemId"}),", ",(0,b.jsx)("code",{children:"quantity"}),", optional ",(0,b.jsx)("code",{children:"locationId"}),", ",(0,b.jsx)("code",{children:"unitCost"}),", and ",(0,b.jsx)("code",{children:"notes"})," for each entry."]})]}),(0,b.jsx)(L.DialogFooter,{children:(0,b.jsx)(K.Button,{type:"submit",disabled:a,children:"Process receipts"})})]}),(0,b.jsx)(ai,{items:e,locations:f,organizations:g})]})}function ai({items:a,locations:d,organizations:e}){let f=(0,c.useMemo)(()=>{let b=a[0],c=d[0],f=e[0];return JSON.stringify({items:[{itemId:b?.id??"ITEM_ID",quantity:10,locationId:c?.id??"LOCATION_ID",unitCost:2.5,notes:"Donation from community partner"}],sourceType:"donation",providerOrganizationId:f?.id??void 0,defaultLocationId:c?.id??void 0,globalNotes:"Monthly restock"},null,2)},[a,d,e]);return(0,b.jsxs)("div",{className:"rounded-lg border border-dashed border-muted-foreground/40 bg-muted/20 p-4 text-label-sm text-muted-foreground",children:[(0,b.jsx)("p",{className:"mb-2 font-medium text-on-surface",children:"Template example"}),(0,b.jsx)("pre",{className:"whitespace-pre-wrap break-words font-mono text-label-sm leading-relaxed",children:f})]})}var aj=(0,S.createServerReference)("40c153c0874e0597d5f04a817d0928aefa366716e4",S.callServer,void 0,S.findSourceMapURL,"createInventoryLocationAction"),ak=(0,S.createServerReference)("40f775c10ca9cf9d6c308ac61d1b52e8a140be2f0e",S.callServer,void 0,S.findSourceMapURL,"deleteInventoryLocationAction"),al=(0,S.createServerReference)("40fd8e40b97335e8e630438a39271991fb2f4f520b",S.callServer,void 0,S.findSourceMapURL,"toggleInventoryLocationAction"),am=(0,S.createServerReference)("403014c4d0ee7a583a8a2c8c5a314df163558e4736",S.callServer,void 0,S.findSourceMapURL,"updateInventoryLocationAction");function an({locations:a,actorProfileId:d,canManageLocations:e}){let f=(0,J.useRouter)(),{toast:g}=(0,P.useToast)(),[h,i]=(0,c.useState)(!1),[j,k]=(0,c.useState)(null),[l,m]=(0,c.useTransition)(),n=(a,b,c)=>{a.success?(c&&c(),g({title:"Location updated",description:b}),m(()=>f.refresh())):g({title:"Location error",variant:"destructive",description:a.error??"Action failed."})},o=async a=>{a.set("actor_profile_id",d),n(await aj(a),"Location created.",()=>i(!1))},p=async a=>{a.set("actor_profile_id",d),n(await am(a),"Location updated.",()=>k(null))},q=async(a,b)=>{let c=new FormData;c.set("actor_profile_id",d),c.set("location_id",a.id),c.set("active",String(b)),n(await al(c),b?"Location activated.":"Location deactivated.")},r=async a=>{let b=new FormData;b.set("actor_profile_id",d),b.set("location_id",a.id),n(await ak(b),"Location deleted.")};return(0,b.jsxs)(E.Card,{className:"border-border/60",children:[(0,b.jsxs)(E.CardHeader,{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(E.CardTitle,{className:"text-title-sm font-semibold",children:"Locations"}),(0,b.jsx)("p",{className:"text-body-md text-muted-foreground",children:"Warehouses, outreach lockers, and mobile units that hold inventory."}),e?null:(0,b.jsx)("p",{className:"text-label-sm text-warning-foreground",children:"Viewing only: only IHARC admins can add or edit locations."})]}),(0,b.jsxs)(L.Dialog,{open:h,onOpenChange:i,children:[(0,b.jsx)(L.DialogTrigger,{asChild:!0,children:(0,b.jsx)(K.Button,{disabled:!e,children:"Create location"})}),(0,b.jsx)(ao,{title:"Create location",actionLabel:"Create location",actorProfileId:d,onSubmit:o,isPending:l,canManageLocations:e})]})]}),(0,b.jsx)(E.CardContent,{className:"overflow-x-auto",children:(0,b.jsxs)(F.Table,{children:[(0,b.jsx)(F.TableHeader,{children:(0,b.jsxs)(F.TableRow,{children:[(0,b.jsx)(F.TableHead,{children:"Name"}),(0,b.jsx)(F.TableHead,{children:"Code"}),(0,b.jsx)(F.TableHead,{children:"Type"}),(0,b.jsx)(F.TableHead,{children:"Status"}),(0,b.jsx)(F.TableHead,{className:"text-right",children:"Actions"})]})}),(0,b.jsx)(F.TableBody,{children:a.map(a=>(0,b.jsxs)(F.TableRow,{className:a.active?void 0:"opacity-60",children:[(0,b.jsx)(F.TableCell,{className:"font-medium",children:a.name}),(0,b.jsx)(F.TableCell,{children:a.code??"—"}),(0,b.jsx)(F.TableCell,{children:a.type??"—"}),(0,b.jsx)(F.TableCell,{children:(0,b.jsx)("span",{className:a.active?"text-primary":"text-muted-foreground",children:a.active?"Active":"Inactive"})}),(0,b.jsxs)(F.TableCell,{className:"space-x-2 text-right",children:[(0,b.jsx)(K.Button,{size:"sm",variant:"outline",onClick:()=>k(a),disabled:!e,children:"Edit"}),(0,b.jsx)(K.Button,{size:"sm",variant:"ghost",onClick:()=>q(a,!a.active),disabled:l||!e,children:a.active?"Deactivate":"Activate"}),(0,b.jsx)(K.Button,{size:"sm",variant:"ghost",className:"text-destructive hover:text-destructive",onClick:()=>r(a),disabled:l||!e,children:"Delete"})]})]},a.id))})]})}),(0,b.jsx)(E.CardFooter,{className:"text-label-sm text-muted-foreground",children:"Deleting a location is only allowed when no stock remains and no transactions reference it. Otherwise deactivate to hide it from workflows."}),(0,b.jsx)(ao,{title:"Edit location",actionLabel:"Save changes",actorProfileId:d,onSubmit:p,isPending:l,defaultValues:j,open:null!==j,onOpenChange:a=>!a&&k(null),canManageLocations:e})]})}function ao({title:a,actionLabel:c,actorProfileId:d,onSubmit:e,isPending:f,defaultValues:g,open:h,onOpenChange:i,canManageLocations:j}){return(0,b.jsx)(L.Dialog,{open:h,onOpenChange:i,children:(0,b.jsxs)(L.DialogContent,{className:"max-w-lg",children:[(0,b.jsxs)(L.DialogHeader,{children:[(0,b.jsx)(L.DialogTitle,{children:a}),(0,b.jsx)(L.DialogDescription,{children:"Track detailed addresses so deliveries and outreach staff know where supplies live."})]}),(0,b.jsxs)("form",{action:e,className:"space-y-4",children:[(0,b.jsx)("input",{type:"hidden",name:"actor_profile_id",value:d}),g?(0,b.jsx)("input",{type:"hidden",name:"location_id",value:g.id}):null,(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(N.Label,{htmlFor:"location_name",children:"Name"}),(0,b.jsx)(M.Input,{id:"location_name",name:"name",defaultValue:g?.name??"",required:!0,disabled:!j})]}),(0,b.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,b.jsx)(ap,{label:"Code",name:"code",defaultValue:g?.code??"",placeholder:"Short code",required:!0,disabled:!j}),(0,b.jsx)(ap,{label:"Type",name:"type",defaultValue:g?.type??"",placeholder:"e.g., Warehouse",required:!0,disabled:!j})]}),(0,b.jsx)(ap,{label:"Address",name:"address",defaultValue:g?.address??"",placeholder:"Street, city",disabled:!j}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(Q.Checkbox,{id:"location_active",name:"active",defaultChecked:g?.active??!0,disabled:!j}),(0,b.jsx)(N.Label,{htmlFor:"location_active",className:"text-body-md text-muted-foreground",children:"Location is active"})]}),(0,b.jsx)(L.DialogFooter,{children:(0,b.jsx)(K.Button,{type:"submit",disabled:f||!j,children:c})})]})]})})}function ap({label:a,name:c,defaultValue:d,placeholder:e,required:f,disabled:g}){return(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(N.Label,{htmlFor:c,children:a}),(0,b.jsx)(M.Input,{id:c,name:c,defaultValue:d??"",placeholder:e,required:f,disabled:g})]})}var aq=(0,S.createServerReference)("403263e68d5afcf0e54388f8c3c082e81b41c0e5e6",S.callServer,void 0,S.findSourceMapURL,"createInventoryOrganizationAction"),ar=(0,S.createServerReference)("408435383f391874e84eaed865e5e05045fc70724a",S.callServer,void 0,S.findSourceMapURL,"deactivateInventoryOrganizationAction"),as=(0,S.createServerReference)("40e5c60a8c1676edfc87099175fd266ba32884246b",S.callServer,void 0,S.findSourceMapURL,"activateInventoryOrganizationAction"),at=(0,S.createServerReference)("40b57083cd9a496d5383e32b42398020dd1ffbba71",S.callServer,void 0,S.findSourceMapURL,"updateInventoryOrganizationAction");function au({organizations:a,actorProfileId:d}){let e=(0,J.useRouter)(),{toast:f}=(0,P.useToast)(),[g,h]=(0,c.useState)(!1),[i,j]=(0,c.useState)(null),[k,l]=(0,c.useTransition)(),m=(a,b,c)=>{a.success?(c&&c(),f({title:"Organisation updated",description:b}),l(()=>e.refresh())):f({title:"Organisation error",variant:"destructive",description:a.error??"Action failed."})},n=async a=>{a.set("actor_profile_id",d),m(await aq(a),"Organization saved.",()=>h(!1))},o=async a=>{a.set("actor_profile_id",d),m(await at(a),"Organization updated.",()=>j(null))},p=async a=>{let b=new FormData;b.set("actor_profile_id",d),b.set("organization_id",String(a.id)),m(await ar(b),"Organization deactivated.")},q=async a=>{let b=new FormData;b.set("actor_profile_id",d),b.set("organization_id",String(a.id)),m(await as(b),"Organization reactivated.")};return(0,b.jsxs)(E.Card,{className:"border-border/60",children:[(0,b.jsxs)(E.CardHeader,{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(E.CardTitle,{className:"text-title-sm font-semibold",children:"Partner organisations"}),(0,b.jsx)("p",{className:"text-body-md text-muted-foreground",children:"Track donors, suppliers, and partners for accurate receipt attribution and reporting."})]}),(0,b.jsxs)(L.Dialog,{open:g,onOpenChange:h,children:[(0,b.jsx)(L.DialogTrigger,{asChild:!0,children:(0,b.jsx)(K.Button,{children:"Add organisation"})}),(0,b.jsx)(av,{title:"Add organisation",actionLabel:"Save organisation",actorProfileId:d,onSubmit:n,isPending:k})]})]}),(0,b.jsx)(E.CardContent,{className:"overflow-x-auto",children:(0,b.jsxs)(F.Table,{children:[(0,b.jsx)(F.TableHeader,{children:(0,b.jsxs)(F.TableRow,{children:[(0,b.jsx)(F.TableHead,{children:"Name"}),(0,b.jsx)(F.TableHead,{children:"Website"}),(0,b.jsx)(F.TableHead,{children:"Status"}),(0,b.jsx)(F.TableHead,{className:"text-right",children:"Actions"})]})}),(0,b.jsx)(F.TableBody,{children:a.map(a=>(0,b.jsxs)(F.TableRow,{className:a.isActive?void 0:"opacity-60",children:[(0,b.jsx)(F.TableCell,{className:"font-medium",children:a.name}),(0,b.jsx)(F.TableCell,{children:a.website??"—"}),(0,b.jsx)(F.TableCell,{children:(0,b.jsx)("span",{className:a.isActive?"text-primary":"text-muted-foreground",children:a.isActive?"Active":"Inactive"})}),(0,b.jsxs)(F.TableCell,{className:"space-x-2 text-right",children:[(0,b.jsx)(K.Button,{size:"sm",variant:"outline",onClick:()=>j(a),children:"Edit"}),a.isActive?(0,b.jsx)(K.Button,{size:"sm",variant:"ghost",className:"text-destructive hover:text-destructive",onClick:()=>p(a),disabled:k,children:"Deactivate"}):(0,b.jsx)(K.Button,{size:"sm",variant:"ghost",className:"text-tertiary hover:text-tertiary",onClick:()=>q(a),disabled:k,children:"Reactivate"})]})]},a.id))})]})}),(0,b.jsx)(E.CardFooter,{className:"text-label-sm text-muted-foreground",children:"Deactivate partners to pause new activity. Reactivate them when donations resume so historic receipts stay intact."}),(0,b.jsx)(av,{title:"Edit organization",actionLabel:"Save changes",actorProfileId:d,onSubmit:o,isPending:k,defaultValues:i,open:null!==i,onOpenChange:a=>!a&&j(null)})]})}function av({title:a,actionLabel:c,actorProfileId:d,onSubmit:e,isPending:f,defaultValues:g,open:h,onOpenChange:i}){return(0,b.jsx)(L.Dialog,{open:h,onOpenChange:i,children:(0,b.jsxs)(L.DialogContent,{className:"max-w-lg",children:[(0,b.jsxs)(L.DialogHeader,{children:[(0,b.jsx)(L.DialogTitle,{children:a}),(0,b.jsx)(L.DialogDescription,{children:"Capture supplier details and websites to simplify follow-up for receipts."})]}),(0,b.jsxs)("form",{action:e,className:"space-y-4",children:[(0,b.jsx)("input",{type:"hidden",name:"actor_profile_id",value:d}),g?(0,b.jsx)("input",{type:"hidden",name:"organization_id",value:String(g.id)}):null,(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(N.Label,{htmlFor:"org_name",children:"Name"}),(0,b.jsx)(M.Input,{id:"org_name",name:"name",defaultValue:g?.name??"",required:!0})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(N.Label,{htmlFor:"org_website",children:"Website"}),(0,b.jsx)(M.Input,{id:"org_website",name:"website",type:"url",defaultValue:g?.website??"",placeholder:"https://example.ca"})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(N.Label,{htmlFor:"org_description",children:"Description"}),(0,b.jsx)(O.Textarea,{id:"org_description",name:"description",rows:3,defaultValue:g?.description??""})]}),(0,b.jsx)(L.DialogFooter,{children:(0,b.jsx)(K.Button,{type:"submit",disabled:f,children:c})})]})]})})}var aw=(0,S.createServerReference)("401deed810cec397afe0dde30ec44d021f5dd2c3e9",S.callServer,void 0,S.findSourceMapURL,"updateInventoryTransactionSourceAction");function ax({receipts:a,organizations:d,actorProfileId:e}){let[f,g]=(0,c.useState)(""),[h,i]=(0,c.useState)(null),[j,k]=(0,c.useTransition)(),l=(0,J.useRouter)(),{toast:m}=(0,P.useToast)(),n=(0,c.useMemo)(()=>{if(!f)return a;let b=f.toLowerCase();return a.filter(a=>[a.itemName,a.locationName??"",a.providerOrgName??"",a.notes??""].some(a=>a.toLowerCase().includes(b)))},[a,f]),o=async a=>{a.set("actor_profile_id",e);let b=await aw(a);b.success?(m({title:"Receipt updated",description:"Receipt source updated."}),i(null),k(()=>l.refresh())):m({title:"Receipt error",variant:"destructive",description:b.error??"Failed to update receipt."})};return(0,b.jsxs)(E.Card,{className:"border-border/60",children:[(0,b.jsxs)(E.CardHeader,{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[(0,b.jsx)(E.CardTitle,{className:"text-title-sm font-semibold",children:"Receipts"}),(0,b.jsx)(M.Input,{className:"w-full sm:w-64",placeholder:"Search receipts",value:f,onChange:a=>g(a.target.value)})]}),(0,b.jsx)(E.CardContent,{className:"overflow-x-auto",children:(0,b.jsxs)(F.Table,{children:[(0,b.jsx)(F.TableHeader,{children:(0,b.jsxs)(F.TableRow,{children:[(0,b.jsx)(F.TableHead,{children:"Item"}),(0,b.jsx)(F.TableHead,{children:"Location"}),(0,b.jsx)(F.TableHead,{children:"Source"}),(0,b.jsx)(F.TableHead,{className:"text-right",children:"Quantity"}),(0,b.jsx)(F.TableHead,{className:"text-right",children:"Received"}),(0,b.jsx)(F.TableHead,{className:"text-right",children:"Actions"})]})}),(0,b.jsx)(F.TableBody,{children:n.map(a=>(0,b.jsxs)(F.TableRow,{children:[(0,b.jsx)(F.TableCell,{className:"font-medium",children:a.itemName}),(0,b.jsx)(F.TableCell,{children:a.locationName??"—"}),(0,b.jsx)(F.TableCell,{children:a.providerOrgName??a.refType??"—"}),(0,b.jsx)(F.TableCell,{className:"text-right",children:a.qty.toLocaleString()}),(0,b.jsx)(F.TableCell,{className:"text-right",children:new Date(a.createdAt).toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"})}),(0,b.jsx)(F.TableCell,{className:"text-right",children:(0,b.jsx)(K.Button,{size:"sm",variant:"outline",onClick:()=>i(a),children:"Update source"})})]},a.id))})]})}),(0,b.jsx)(ay,{receipt:h,organizations:d,actorProfileId:e,isPending:j,onClose:()=>i(null),onSubmit:o})]})}function ay({receipt:a,organizations:c,actorProfileId:d,isPending:e,onSubmit:f,onClose:g}){return(0,b.jsx)(L.Dialog,{open:!!a,onOpenChange:a=>!a&&g(),children:(0,b.jsxs)(L.DialogContent,{className:"max-w-lg",children:[(0,b.jsxs)(L.DialogHeader,{children:[(0,b.jsx)(L.DialogTitle,{children:"Update receipt source"}),(0,b.jsx)(L.DialogDescription,{children:"Attach or correct the provider for this receipt. This keeps reporting accurate across teams."})]}),a?(0,b.jsxs)("form",{action:f,className:"space-y-4",children:[(0,b.jsx)("input",{type:"hidden",name:"actor_profile_id",value:d}),(0,b.jsx)("input",{type:"hidden",name:"transaction_id",value:a.id}),(0,b.jsxs)("div",{className:"grid gap-1",children:[(0,b.jsx)(N.Label,{children:"Item"}),(0,b.jsx)("p",{className:"text-body-md font-medium text-on-surface",children:a.itemName})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(N.Label,{htmlFor:"receipt_source_type",children:"Source type"}),(0,b.jsxs)("select",{id:"receipt_source_type",name:"source_type",defaultValue:a.refType??"",className:"rounded-md border border-input bg-background px-3 py-2 text-body-md shadow-sm focus:outline-none",children:[(0,b.jsx)("option",{value:"",children:"Unset"}),(0,b.jsx)("option",{value:"donation",children:"Donation"}),(0,b.jsx)("option",{value:"purchase",children:"Purchase"}),(0,b.jsx)("option",{value:"transfer_in",children:"Transfer in"}),(0,b.jsx)("option",{value:"adjustment",children:"Adjustment"})]})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(N.Label,{htmlFor:"receipt_provider",children:"Provider organisation"}),(0,b.jsxs)("select",{id:"receipt_provider",name:"provider_org_id",defaultValue:a.providerOrgId?.toString()??"",className:"rounded-md border border-input bg-background px-3 py-2 text-body-md shadow-sm focus:outline-none",children:[(0,b.jsx)("option",{value:"",children:"None"}),c.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))]})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(N.Label,{htmlFor:"receipt_notes",children:"Notes"}),(0,b.jsx)(M.Input,{id:"receipt_notes",name:"notes",defaultValue:a.notes??"",placeholder:"Optional comments"})]}),(0,b.jsx)(L.DialogFooter,{children:(0,b.jsx)(K.Button,{type:"submit",disabled:e,children:"Save changes"})})]}):null]})})}function az({bootstrap:a,actorProfileId:d,canManageLocations:e}){let[f,g]=(0,c.useState)("dashboard");return(0,b.jsx)("div",{className:"space-y-6",children:(0,b.jsxs)(r,{value:f,onValueChange:g,className:"space-y-6",children:[(0,b.jsxs)(B,{className:"flex w-full flex-wrap justify-start gap-2 bg-transparent p-0",children:[(0,b.jsx)(C,{value:"dashboard",className:"rounded-full border px-4 py-1 text-body-md",children:"Dashboard"}),(0,b.jsx)(C,{value:"items",className:"rounded-full border px-4 py-1 text-body-md",children:"Items"}),(0,b.jsx)(C,{value:"locations",className:"rounded-full border px-4 py-1 text-body-md",children:"Locations"}),(0,b.jsx)(C,{value:"organizations",className:"rounded-full border px-4 py-1 text-body-md",children:"Organisations"}),(0,b.jsx)(C,{value:"receipts",className:"rounded-full border px-4 py-1 text-body-md",children:"Receipts"})]}),(0,b.jsx)(D,{value:"dashboard",children:(0,b.jsx)(G,{dashboard:a.dashboard})}),(0,b.jsx)(D,{value:"items",children:(0,b.jsx)(aa,{items:a.items,locations:a.locations,organizations:a.organizations,categories:a.categories,actorProfileId:d})}),(0,b.jsx)(D,{value:"locations",children:(0,b.jsx)(an,{locations:a.locations,actorProfileId:d,canManageLocations:e})}),(0,b.jsx)(D,{value:"organizations",children:(0,b.jsx)(au,{organizations:a.organizations,actorProfileId:d})}),(0,b.jsx)(D,{value:"receipts",children:(0,b.jsx)(ax,{receipts:a.receipts,organizations:a.organizations,actorProfileId:d})})]})})}a.s(["InventoryWorkspace",()=>az],63331)}];

//# sourceMappingURL=src_components_admin_inventory_inventory-workspace_tsx_e9f8effd._.js.map