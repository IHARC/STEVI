module.exports=[63985,a=>{"use strict";let b="[redacted]",c=["password","token","secret","authorization","cookie","session","otp","code","sin","ssn","birth","dob","email","phone","contact","address"];function d(a){if(null===a||"object"!=typeof a)return!1;let b=Object.getPrototypeOf(a);return b===Object.prototype||null===b}let e=/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i,f=/^[0-9]+$/,g=/^[a-z0-9_]+$/i,h=/^[a-zA-Z0-9._:-]+$/;function i(a){if(null==a)return null;let b="number"==typeof a?String(a):a.trim?.()??a;return"string"!=typeof b||0===b.length?null:e.test(b)||f.test(b)?b:b.slice(0,128)}function j(a){let b=i(a);return b&&e.test(b)?b:null}function k(a){if(!a)return null;let{schema:b,table:c,id:d}=a;if(!g.test(b)||!g.test(c))return null;let e=i(d);return e&&h.test(e)?`${b.toLowerCase()}.${c.toLowerCase()}:${e}`:null}async function l(a,{actorProfileId:e=null,action:f,entityType:g,entityRef:h,entityId:i,meta:l}){let m=l&&d(l)?function a(e,f){let g={};return Object.entries(e).forEach(([e,h])=>{let i;if(i=e.toLowerCase(),c.some(a=>i.includes(a))){g[e]=b;return}let j=function c(e,f){if(void 0!==e){if(null===e)return null;if("string"==typeof e)return e.length>1024?`${e.slice(0,1024)}...`:e;if("number"==typeof e||"boolean"==typeof e)return e;if("bigint"==typeof e)return e.toString();if(e instanceof Date)return e.toISOString();if(e instanceof URL)return e.toString();if(e instanceof Error)return{name:e.name,message:e.message};if(Array.isArray(e))return e.map(a=>c(a,f)).filter(a=>void 0!==a);if(e instanceof Set)return Array.from(e).map(a=>c(a,f)).filter(a=>void 0!==a);if(e instanceof Map){let a={};return e.forEach((b,d)=>{let e=c(b,f);void 0!==e&&(a[String(d)]=e)}),a}return"object"==typeof e&&d(e)?f.has(e)?b:(f.add(e),a(e,f)):String(e)}}(h,f);void 0!==j&&(g[e]=j)}),g}(l,new WeakSet):{},n="string"==typeof h?h:k(h),o=j(i);!o&&n&&(o=j(n.split(":").pop()??null));let p=!n||"entity_ref"in m?m:{...m,entity_ref:n},q=j(e),{error:r}=await a.rpc("portal_log_audit_event",{p_action:f,p_entity_type:g,p_entity_id:o,p_meta:p,p_actor_profile_id:q});if(r)throw r}a.s(["buildEntityRef",()=>k,"logAuditEvent",()=>l],63985)},13095,(a,b,c)=>{"use strict";function d(a){for(let b=0;b<a.length;b++){let c=a[b];if("function"!=typeof c)throw Object.defineProperty(Error(`A "use server" file can only export async functions, found ${typeof c}.
Read more: https://nextjs.org/docs/messages/invalid-use-server-value`),"__NEXT_ERROR_CODE",{value:"E352",enumerable:!1,configurable:!0})}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"ensureServerEntryExports",{enumerable:!0,get:function(){return d}})},19637,a=>{"use strict";var b=a.i(7997),c=a.i(96942),d=a.i(39138),e=a.i(59797);let f=(0,c.cva)("inline-flex items-center rounded-[var(--md-sys-shape-corner-extra-small)] border px-2.5 py-0.5 text-label-sm transition-colors motion-duration-short motion-ease-standard focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}}),g={default:"brand",secondary:"supportive",destructive:"destructive",outline:"neutral"};function h({className:a,variant:c,stateLayerTone:h,...i}){let j=g[c??"default"],k=(0,e.getStateLayerClasses)(h??j);return(0,b.jsx)("div",{className:(0,d.cn)(f({variant:c}),k,a),...i})}a.s(["Badge",()=>h])},35330,a=>{"use strict";var b=a.i(7997),c=a.i(717),d=a.i(39138);let e=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("rounded-[var(--md-sys-shape-corner-medium)] border border-outline/12 bg-surface-container-low text-body-md text-on-surface shadow-level-1",a),...c}));e.displayName="Card";let f=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("flex flex-col gap-space-sm p-space-lg pb-space-sm text-on-surface",a),...c}));f.displayName="CardHeader";let g=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("h3",{ref:e,className:(0,d.cn)("text-title-lg font-medium leading-tight",a),...c}));g.displayName="CardTitle";let h=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("p",{ref:e,className:(0,d.cn)("text-body-sm text-on-surface-variant",a),...c}));h.displayName="CardDescription";let i=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("p-space-lg pt-0 text-body-md text-on-surface",a),...c}));i.displayName="CardContent",c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("flex items-center gap-space-sm p-space-lg pt-0",a),...c})).displayName="CardFooter",a.s(["Card",()=>e,"CardContent",()=>i,"CardDescription",()=>h,"CardHeader",()=>f,"CardTitle",()=>g])},96942,59797,a=>{"use strict";var b=a.i(84347);let c=a=>"boolean"==typeof a?`${a}`:0===a?"0":a,d=b.clsx;a.s(["cva",0,(a,b)=>e=>{var f;if((null==b?void 0:b.variants)==null)return d(a,null==e?void 0:e.class,null==e?void 0:e.className);let{variants:g,defaultVariants:h}=b,i=Object.keys(g).map(a=>{let b=null==e?void 0:e[a],d=null==h?void 0:h[a];if(null===b)return null;let f=c(b)||c(d);return g[a][f]}),j=e&&Object.entries(e).reduce((a,b)=>{let[c,d]=b;return void 0===d||(a[c]=d),a},{});return d(a,i,null==b||null==(f=b.compoundVariants)?void 0:f.reduce((a,b)=>{let{class:c,className:d,...e}=b;return Object.entries(e).every(a=>{let[b,c]=a;return Array.isArray(c)?c.includes({...h,...j}[b]):({...h,...j})[b]===c})?[...a,c,d]:a},[]),null==e?void 0:e.class,null==e?void 0:e.className)}],96942);let e="hover:state-layer-hover focus-visible:state-layer-focus active:state-layer-pressed",f={primary:`state-layer-color-primary ${e}`,"primary-container":`state-layer-color-primary-container ${e}`,secondary:`state-layer-color-secondary ${e}`,"secondary-container":`state-layer-color-secondary-container ${e}`,surface:`state-layer-color-surface ${e}`,"surface-container":`state-layer-color-surface-container ${e}`,inverse:`state-layer-color-inverse-surface ${e}`,error:`state-layer-color-error ${e}`},g={...f,brand:f.primary,"brand-soft":f["primary-container"],supportive:f.secondary,"supportive-container":f["secondary-container"],destructive:f.error,neutral:f.surface,"neutral-container":f["surface-container"]};function h(a){return a?g[a]:""}a.s(["getStateLayerClasses",()=>h],59797)},38904,63770,a=>{"use strict";let b,c,d;var e=a.i(7997),f=a.i(717);function g(a,b){if("function"==typeof a)return a(b);null!=a&&(a.current=b)}function h(...a){return b=>{let c=!1,d=a.map(a=>{let d=g(a,b);return c||"function"!=typeof d||(c=!0),d});if(c)return()=>{for(let b=0;b<d.length;b++){let c=d[b];"function"==typeof c?c():g(a[b],null)}}}}a.s(["composeRefs",()=>h],63770);var i=((d=f.forwardRef((a,b)=>{let{children:c,...d}=a;if(f.isValidElement(c)){var e;let a,g,i=(e=c,(g=(a=Object.getOwnPropertyDescriptor(e.props,"ref")?.get)&&"isReactWarning"in a&&a.isReactWarning)?e.ref:(g=(a=Object.getOwnPropertyDescriptor(e,"ref")?.get)&&"isReactWarning"in a&&a.isReactWarning)?e.props.ref:e.props.ref||e.ref),j=function(a,b){let c={...b};for(let d in b){let e=a[d],f=b[d];/^on[A-Z]/.test(d)?e&&f?c[d]=(...a)=>{let b=f(...a);return e(...a),b}:e&&(c[d]=e):"style"===d?c[d]={...e,...f}:"className"===d&&(c[d]=[e,f].filter(Boolean).join(" "))}return{...a,...c}}(d,c.props);return c.type!==f.Fragment&&(j.ref=b?h(b,i):i),f.cloneElement(c,j)}return f.Children.count(c)>1?f.Children.only(null):null})).displayName="Slot.SlotClone",b=d,(c=f.forwardRef((a,c)=>{let{children:d,...g}=a,h=f.Children.toArray(d),i=h.find(k);if(i){let a=i.props.children,d=h.map(b=>b!==i?b:f.Children.count(a)>1?f.Children.only(null):f.isValidElement(a)?a.props.children:null);return(0,e.jsx)(b,{...g,ref:c,children:f.isValidElement(a)?f.cloneElement(a,void 0,d):null})}return(0,e.jsx)(b,{...g,ref:c,children:d})})).displayName="Slot.Slot",c),j=Symbol("radix.slottable");function k(a){return f.isValidElement(a)&&"function"==typeof a.type&&"__radixId"in a.type&&a.type.__radixId===j}var l=a.i(96942),m=a.i(39138),n=a.i(59797);let o=(0,l.cva)("inline-flex items-center justify-center gap-space-xs whitespace-nowrap rounded-[var(--md-sys-shape-corner-extra-small)] text-label-lg transition-colors motion-duration-short motion-ease-standard focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2 focus-visible:ring-offset-surface disabled:pointer-events-none disabled:opacity-60 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-level-2 hover:bg-primary/92 focus-visible:ring-primary",destructive:"bg-destructive text-destructive-foreground shadow-level-2 hover:bg-destructive/90 focus-visible:ring-destructive",outline:"border border-outline bg-surface text-on-surface shadow-level-1 hover:bg-surface-container focus-visible:ring-primary",secondary:"bg-secondary-container text-on-secondary-container shadow-level-1 hover:bg-secondary-container/90 focus-visible:ring-secondary",ghost:"text-primary focus-visible:ring-primary",link:"text-primary underline-offset-4 hover:underline focus-visible:ring-transparent"},size:{default:"h-10 px-space-md",sm:"h-8 px-space-sm text-label-md",lg:"h-11 px-space-lg text-label-lg",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),p={default:"brand",destructive:"destructive",outline:"neutral",secondary:"supportive-container",ghost:"brand",link:null},q=f.forwardRef(({className:a,variant:b,size:c,stateLayerTone:d,asChild:f=!1,...g},h)=>{let j=p[b??"default"],k=(0,n.getStateLayerClasses)(d??j);return(0,e.jsx)(f?i:"button",{className:(0,m.cn)(o({variant:b,size:c}),k,a),ref:h,...g})});q.displayName="Button",a.s(["Button",()=>q],38904)},22359,a=>{"use strict";var b=a.i(7997),c=a.i(717),d=a.i(39138);let e={indicator:"var(--md-sys-spacing-xs)",control:"calc(var(--md-sys-spacing-sm) - (var(--md-sys-spacing-2xs)/2))",xs:"var(--md-sys-size-icon-xs)",sm:"var(--md-sys-size-icon-sm)",md:"var(--md-sys-size-icon-md)",lg:"var(--md-sys-size-icon-lg)"},f=c.forwardRef(({icon:a,className:c,size:f="md",strokeWidth:g=1.5,decorative:h=!0,style:i,...j},k)=>{let l=e[f]??e.md;return(0,b.jsx)(a,{ref:k,"aria-hidden":!!h||void 0,role:h?void 0:"img",focusable:"false",className:(0,d.cn)("shrink-0 text-inherit",c),style:{width:l,height:l,...i},strokeWidth:g,...j})});f.displayName="Icon",a.s(["Icon",0,f])},36317,a=>{"use strict";var b=a.i(7997),c=a.i(37936),d=a.i(95936);a.i(70396);var e=a.i(73727),f=a.i(9919),g=a.i(42145),h=a.i(65108),i=a.i(77175),j=a.i(35330),k=a.i(38904),l=a.i(55583),m=a.i(43562),n=a.i(70444),o=a.i(45310),p=a.i(19637),q=a.i(41923),r=a.i(46592);let s=async function(a){let b=await (0,i.createOrganizationAction)(a);if(!b.success)throw Error(b.error)};async function t(){let a=await (0,f.createSupabaseRSCClient)(),c=await (0,h.loadPortalAccess)(a);c||(0,e.redirect)("/login?next=/admin/organizations"),c.canAccessAdminWorkspace||(0,e.redirect)((0,r.resolveDefaultWorkspacePath)(c)),await (0,g.ensurePortalProfile)(a,c.userId);let i=a.schema("core"),{data:t,error:u}=await i.from("organizations").select("id, name, website, organization_type, partnership_type, status, is_active, services_tags").order("name");if(u)throw u;let v=t??[];return(0,b.jsxs)("div",{className:"space-y-space-lg",children:[(0,b.jsxs)("header",{className:"space-y-space-xs",children:[(0,b.jsx)("p",{className:"text-label-sm font-medium uppercase text-muted-foreground",children:"Admin"}),(0,b.jsx)("h1",{className:"text-headline-lg",children:"Organizations"}),(0,b.jsx)("p",{className:"max-w-3xl text-body-md text-muted-foreground",children:"Create, edit, and review partner organizations. Admins can seed initial org admins so teams can self-manage members under RLS."})]}),(0,b.jsxs)(j.Card,{children:[(0,b.jsxs)(j.CardHeader,{children:[(0,b.jsx)(j.CardTitle,{className:"text-title-lg",children:"Create organization"}),(0,b.jsx)(j.CardDescription,{children:"Set the basics now, refine details and feature access in the manage view."})]}),(0,b.jsx)(j.CardContent,{children:(0,b.jsxs)("form",{className:"grid gap-space-md md:grid-cols-3",action:s,children:[(0,b.jsxs)("div",{className:"space-y-space-xs md:col-span-2",children:[(0,b.jsx)(m.Label,{htmlFor:"name",children:"Name"}),(0,b.jsx)(l.Input,{id:"name",name:"name",required:!0,placeholder:"Community Food Bank"})]}),(0,b.jsxs)("div",{className:"space-y-space-xs",children:[(0,b.jsx)(m.Label,{htmlFor:"status",children:"Status"}),(0,b.jsxs)(n.Select,{name:"status",defaultValue:"active",children:[(0,b.jsx)(n.SelectTrigger,{id:"status",children:(0,b.jsx)(n.SelectValue,{placeholder:"Select status"})}),(0,b.jsxs)(n.SelectContent,{children:[(0,b.jsx)(n.SelectItem,{value:"active",children:"Active"}),(0,b.jsx)(n.SelectItem,{value:"pending",children:"Pending"}),(0,b.jsx)(n.SelectItem,{value:"under_review",children:"Under review"}),(0,b.jsx)(n.SelectItem,{value:"inactive",children:"Inactive"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-space-xs",children:[(0,b.jsx)(m.Label,{htmlFor:"organization_type",children:"Organization type"}),(0,b.jsxs)(n.Select,{name:"organization_type",children:[(0,b.jsx)(n.SelectTrigger,{id:"organization_type",children:(0,b.jsx)(n.SelectValue,{placeholder:"Select type"})}),(0,b.jsx)(n.SelectContent,{children:["addiction","crisis_support","food_services","housing","mental_health","multi_service","healthcare","government","non_profit","faith_based","community_center","legal_services","other"].map(a=>(0,b.jsx)(n.SelectItem,{value:a,children:a.replace(/_/g," ")},a))})]})]}),(0,b.jsxs)("div",{className:"space-y-space-xs",children:[(0,b.jsx)(m.Label,{htmlFor:"partnership_type",children:"Partnership type"}),(0,b.jsxs)(n.Select,{name:"partnership_type",children:[(0,b.jsx)(n.SelectTrigger,{id:"partnership_type",children:(0,b.jsx)(n.SelectValue,{placeholder:"Select partnership"})}),(0,b.jsx)(n.SelectContent,{children:["referral_partner","service_provider","funding_partner","collaborative_partner","resource_partner","other"].map(a=>(0,b.jsx)(n.SelectItem,{value:a,children:a.replace(/_/g," ")},a))})]})]}),(0,b.jsxs)("div",{className:"space-y-space-xs",children:[(0,b.jsx)(m.Label,{htmlFor:"website",children:"Website"}),(0,b.jsx)(l.Input,{id:"website",name:"website",type:"url",placeholder:"https://example.org"})]}),(0,b.jsxs)("div",{className:"space-y-space-xs",children:[(0,b.jsxs)(m.Label,{className:"flex items-center gap-space-xs text-body-sm",children:[(0,b.jsx)("input",{type:"checkbox",name:"is_active",defaultChecked:!0,className:"h-4 w-4 rounded border border-input"}),(0,b.jsx)("span",{children:"Mark as active"})]}),(0,b.jsx)("p",{className:"text-label-sm text-muted-foreground",children:"Unchecked organizations remain in draft."})]}),(0,b.jsxs)("div",{className:"md:col-span-3",children:[(0,b.jsx)(m.Label,{className:"text-body-sm",children:"Feature availability"}),(0,b.jsx)("div",{className:"mt-space-sm grid gap-space-xs sm:grid-cols-3",children:q.ORG_FEATURE_OPTIONS.map(a=>(0,b.jsxs)("label",{className:"flex items-center gap-space-xs rounded-md border border-outline/20 px-space-sm py-space-xs text-body-sm",children:[(0,b.jsx)("input",{type:"checkbox",name:"features",value:a.value,className:"h-4 w-4 rounded border border-input"}),(0,b.jsx)("span",{children:a.label})]},a.value))})]}),(0,b.jsx)("div",{className:"md:col-span-3 flex justify-end",children:(0,b.jsx)(k.Button,{type:"submit",children:"Create organization"})})]})})]}),(0,b.jsxs)(j.Card,{children:[(0,b.jsxs)(j.CardHeader,{children:[(0,b.jsx)(j.CardTitle,{className:"text-title-lg",children:"Organizations"}),(0,b.jsx)(j.CardDescription,{children:"Manage details, features, and membership for each organization."})]}),(0,b.jsx)(j.CardContent,{className:"overflow-x-auto",children:(0,b.jsxs)(o.Table,{children:[(0,b.jsx)(o.TableHeader,{children:(0,b.jsxs)(o.TableRow,{children:[(0,b.jsx)(o.TableHead,{children:"Name"}),(0,b.jsx)(o.TableHead,{children:"Type"}),(0,b.jsx)(o.TableHead,{children:"Partnership"}),(0,b.jsx)(o.TableHead,{children:"Status"}),(0,b.jsx)(o.TableHead,{children:"Features"}),(0,b.jsx)(o.TableHead,{className:"text-right",children:"Actions"})]})}),(0,b.jsx)(o.TableBody,{children:0===v.length?(0,b.jsx)(o.TableRow,{children:(0,b.jsx)(o.TableCell,{colSpan:6,className:"text-center text-muted-foreground",children:"No organizations yet. Create one to get started."})}):v.map(a=>{var c;let e=(0,q.extractOrgFeatureFlags)(a.services_tags),f=a.status??(!1===a.is_active?"inactive":"active");return(0,b.jsxs)(o.TableRow,{children:[(0,b.jsx)(o.TableCell,{className:"font-medium",children:(0,b.jsxs)("div",{className:"flex flex-col gap-space-2xs",children:[(0,b.jsx)("span",{className:"text-on-surface",children:a.name}),a.website?(0,b.jsx)("span",{className:"text-label-sm text-muted-foreground",children:a.website}):null]})}),(0,b.jsx)(o.TableCell,{className:"capitalize text-muted-foreground",children:a.organization_type?.replace(/_/g," ")??"—"}),(0,b.jsx)(o.TableCell,{className:"capitalize text-muted-foreground",children:a.partnership_type?.replace(/_/g," ")??"—"}),(0,b.jsx)(o.TableCell,{children:(0,b.jsx)(p.Badge,{variant:(c=a.status,!1===a.is_active||"inactive"===c?"secondary":"pending"===c||"under_review"===c?"outline":"default"),children:f?.replace(/_/g," ")})}),(0,b.jsx)(o.TableCell,{className:"max-w-xs",children:e.length?(0,b.jsx)("div",{className:"flex flex-wrap gap-space-2xs",children:e.map(a=>(0,b.jsx)(p.Badge,{variant:"outline",className:"capitalize",children:a.replace(/_/g," ")},a))}):(0,b.jsx)("span",{className:"text-muted-foreground text-sm",children:"None"})}),(0,b.jsx)(o.TableCell,{className:"text-right",children:(0,b.jsx)(k.Button,{asChild:!0,variant:"outline",size:"sm",children:(0,b.jsx)(d.default,{href:`/admin/organizations/${a.id}`,children:"Manage"})})})]},a.id)})})]})})]})]})}(0,c.registerServerReference)(s,"40a3386c1457dcc9c46b1c64b7a4f35e86fc44034f",null),a.s(["$$RSC_SERVER_ACTION_0",0,s,"default",()=>t,"dynamic",0,"force-dynamic"])},37722,a=>{"use strict";var b=a.i(86731),c=a.i(36317),d=a.i(77175);a.s([],93444),a.i(93444),a.s(["00b7ee4fee263fec1fe8acb860989f6ddb47485e3a",()=>b.$$RSC_SERVER_ACTION_0,"4041b919bc1688f605bdd5131e671fac39b2bf4a55",()=>d.adminToggleOrgMemberRoleAction,"40589e6132aca61018d08150deab69bf8b00940101",()=>d.deleteOrganizationAction,"4080609d50b5cf5b3d33c7e1137a69d52a6d6a90c4",()=>d.createOrganizationAction,"409cd60fb3123e6882e30d164e64ebd523e0edf08c",()=>d.attachOrgMemberAction,"40a3386c1457dcc9c46b1c64b7a4f35e86fc44034f",()=>c.$$RSC_SERVER_ACTION_0,"40dd757dfb67f34fee1dad955a7c0a541566f2d484",()=>d.updateOrganizationAction,"40eec4085a13bd85d094fafe1b23fb313b3813447c",()=>d.adminRemoveOrgMemberAction],37722)}];

//# sourceMappingURL=_5d378e34._.js.map