module.exports=[10508,a=>{"use strict";let b=new Map;function c(a){let b=new Set;for(let c of a)"string"==typeof c&&c.trim()&&b.add(c);return Array.from(b).sort((a,b)=>a.localeCompare(b))}function d(a){return a.replace(/_/g," ").replace(/-/g," ").replace(/\s+/g," ").trim().replace(/\b\w/g,a=>a.toUpperCase())}function e(a){return a.map(a=>({value:a,label:d(a)}))}async function f(a,d){let e=function(a){let{schema:b,table:c,column:d,prefix:e,domainEquals:f}=a;return[b,c,d,e??"",f??""].join("::")}(d),f=b.get(e);if(f)return f;let g=(async()=>{let b=a.schema(d.schema);if("role_permissions"===d.table&&d.domainEquals){let{data:a,error:e}=await b.from("permissions").select("id").eq("domain",d.domainEquals);if(e)throw e;let f=(a??[]).map(a=>a.id);if(0===f.length)return[];let{data:g,error:h}=await b.from("role_permissions").select("role_id").in("permission_id",f);if(h)throw h;let i=(g??[]).map(a=>a.role_id);if(0===i.length)return[];let{data:j,error:k}=await b.from("roles").select("name").in("id",i);if(k)throw k;return c((j??[]).map(a=>a.name))}let e=b.from(d.table).select(d.column,{distinct:!0});d.prefix&&(e=e.like(d.column,`${d.prefix}%`));let{data:f,error:g}=await e.order(d.column,{ascending:!0});if(g)throw g;return c((f??[]).map(a=>a[d.column]))})();return b.set(e,g),g}let g={schema:"core",table:"person_access_grants",column:"scope"},h={schema:"portal",table:"profiles",column:"affiliation_status"},i={schema:"portal",table:"profiles",column:"affiliation_type"},j={schema:"portal",table:"profiles",column:"government_role_type"},k={schema:"portal",table:"policies",column:"status"},l={schema:"portal",table:"policies",column:"category"},m={schema:"portal",table:"resource_pages",column:"kind"},n={schema:"portal",table:"resource_pages",column:"embed_placement"},o={schema:"portal",table:"profiles",column:"homelessness_experience"},p={schema:"core",table:"roles",column:"name",prefix:"portal_"},q={schema:"core",table:"roles",column:"name",prefix:"iharc_"},r={schema:"core",table:"role_permissions",column:"role_id",domainEquals:"inventory"};async function s(a){return f(a,g)}async function t(a){return f(a,h)}async function u(a){return f(a,i)}async function v(a){return f(a,j)}async function w(a){return f(a,k)}async function x(a){return f(a,l)}async function y(a){return f(a,m)}async function z(a){return f(a,n)}async function A(a){return f(a,o)}async function B(a){return f(a,p)}async function C(a){return f(a,q)}async function D(a){return f(a,r)}a.s(["formatEnumLabel",()=>d,"getAffiliationStatuses",()=>t,"getAffiliationTypes",()=>u,"getGovernmentRoleTypes",()=>v,"getGrantScopes",()=>s,"getIharcRoles",()=>C,"getInventoryRoles",()=>D,"getLivedExperienceStatuses",()=>A,"getPolicyCategories",()=>x,"getPolicyStatuses",()=>w,"getPortalRoles",()=>B,"getResourceEmbedPlacements",()=>z,"getResourceKinds",()=>y,"toOptions",()=>e])},65108,4985,a=>{"use strict";var b=a.i(42145),c=a.i(10508);let d=a=>a.isProfileApproved&&(a.portalRoles.includes("portal_admin")||a.iharcRoles.includes("iharc_admin")),e=[{id:"client",label:"Client workspace",defaultRoute:"/home",groups:[{id:"client-today",label:"Today",icon:"home",items:[{id:"client-home",href:"/home",label:"Home",icon:"home",match:["/home"]},{id:"client-appointments-upcoming",href:"/appointments",label:"Upcoming appointments",icon:"calendar",exact:!0},{id:"client-appointments-past",href:"/appointments/past",label:"Past appointments",icon:"calendarRange",match:["/appointments/past"]}]},{id:"client-support",label:"Care & support",icon:"lifebuoy",items:[{id:"client-cases",href:"/cases",label:"My cases",icon:"briefcase",match:["/cases"]},{id:"client-support-requests",href:"/support",label:"Support requests",icon:"lifebuoy",match:["/support"]},{id:"client-messages",href:"/messages",label:"Messages",icon:"message",match:["/messages"]}]},{id:"client-records",label:"Records",icon:"file",items:[{id:"client-documents",href:"/documents",label:"Documents",icon:"file",match:["/documents"]},{id:"client-resources",href:"/resources",label:"Resources",icon:"book",match:["/resources"]}]},{id:"client-profile",label:"Profile & consents",icon:"shield",items:[{id:"client-profile",href:"/profile",label:"Profile",icon:"settings",exact:!0},{id:"client-consents",href:"/profile/consents",label:"Consents",icon:"shield",match:["/profile/consents"]}]}]},{id:"staff",label:"Staff workspace",defaultRoute:"/staff/overview",groups:[{id:"staff-caseload",label:"Caseload",icon:"dashboard",items:[{id:"staff-overview",href:"/staff/overview",label:"Overview",icon:"dashboard",match:["/staff/overview"],requires:a=>a.canAccessStaffWorkspace},{id:"staff-caseload-active",href:"/staff/caseload",label:"Active caseload",icon:"users",match:["/staff/caseload"],requires:a=>a.canAccessStaffWorkspace},{id:"staff-cases-all",href:"/staff/cases",label:"All cases",icon:"briefcase",match:["/staff/cases"],requires:a=>a.canAccessStaffWorkspace},{id:"staff-intake",href:"/staff/intake",label:"Intake queue",icon:"inbox",match:["/staff/intake"],requires:a=>a.canAccessStaffWorkspace}]},{id:"staff-tasks",label:"Tasks & workflows",icon:"list",items:[{id:"staff-my-tasks",href:"/staff/tasks",label:"My tasks",icon:"list",match:["/staff/tasks"],requires:a=>a.canAccessStaffWorkspace},{id:"staff-team-tasks",href:"/staff/tasks/team",label:"Team tasks",icon:"users",match:["/staff/tasks/team"],requires:a=>a.canAccessStaffWorkspace}]},{id:"staff-field",label:"Field operations",icon:"route",items:[{id:"staff-appointments",href:"/staff/appointments",label:"Appointments",icon:"calendar",match:["/staff/appointments"],requires:a=>a.canAccessStaffWorkspace},{id:"staff-schedule",href:"/staff/schedule",label:"Schedule",icon:"calendarRange",match:["/staff/schedule"],requires:a=>a.canAccessStaffWorkspace},{id:"staff-outreach-log",href:"/staff/outreach",label:"Outreach log",icon:"notebook",exact:!0,requires:a=>a.canAccessStaffWorkspace},{id:"staff-outreach-schedule",href:"/staff/outreach/schedule",label:"Outreach schedule",icon:"calendarRange",match:["/staff/outreach/schedule"],requires:a=>a.canAccessStaffWorkspace},{id:"staff-encampments",href:"/staff/outreach/encampments",label:"Encampment list",icon:"tent",match:["/staff/outreach/encampments"],requires:a=>a.canAccessStaffWorkspace},{id:"staff-outreach-map",href:"/staff/outreach/map",label:"Outreach map",icon:"map",match:["/staff/outreach/map"],requires:a=>a.canAccessStaffWorkspace}]},{id:"staff-shifts",label:"Shifts & logs",icon:"clock",items:[{id:"staff-shift-logs",href:"/staff/shifts/logs",label:"Shift logs",icon:"clock",match:["/staff/shifts/logs"],requires:a=>a.canAccessStaffWorkspace}]}]},{id:"admin",label:"Admin workspace",defaultRoute:"/admin/operations",groups:[{id:"admin-operations",label:"Operations",icon:"dashboard",items:[{id:"admin-operations-overview",href:"/admin/operations",label:"Operations overview",icon:"dashboard",match:["/admin/operations"],requires:a=>a.canAccessAdminWorkspace},{id:"admin-approvals",href:"/admin/approvals",label:"Approvals queue",icon:"approval",match:["/admin/approvals"],requires:d},{id:"admin-appointments",href:"/admin/appointments",label:"Scheduling & appointments",icon:"calendar",match:["/admin/appointments"],requires:a=>a.canAccessAdminWorkspace},{id:"admin-warming-room",href:"/admin/warming-room",label:"Warming room ops",icon:"flame",match:["/admin/warming-room"],requires:d},{id:"admin-service-rules",href:"/admin/service-rules",label:"Service rules & algorithms",icon:"workflow",match:["/admin/service-rules"],requires:d},{id:"admin-templates",href:"/admin/templates",label:"Templates & tests",icon:"lab",match:["/admin/templates"],requires:d}]},{id:"admin-clients",label:"Clients & consents",icon:"users",items:[{id:"admin-clients-directory",href:"/admin/clients",label:"Client directory",icon:"users",match:["/admin/clients"],requires:a=>a.canManageConsents},{id:"admin-consents",href:"/admin/consents",label:"Consent overrides",icon:"shield",match:["/admin/consents"],requires:a=>a.canManageConsents}]},{id:"admin-access",label:"Access & people",icon:"users",items:[{id:"admin-users",href:"/admin/users",label:"Users",icon:"users",match:["/admin/users"],requires:a=>a.isProfileApproved&&(a.portalRoles.includes("portal_admin")||a.iharcRoles.includes("iharc_admin")||a.portalRoles.includes("portal_org_admin"))},{id:"admin-permissions",href:"/admin/permissions",label:"Permissions",icon:"shield",match:["/admin/permissions"],requires:d},{id:"admin-profiles",href:"/admin/profiles",label:"Profiles & invites",icon:"idCard",match:["/admin/profiles"],requires:d},{id:"admin-organizations",href:"/admin/organizations",label:"Organizations",icon:"building",match:["/admin/organizations"],requires:d}]},{id:"admin-content",label:"Content & comms",icon:"megaphone",items:[{id:"admin-resources",href:"/admin/resources",label:"Resource library",icon:"notebook",match:["/admin/resources"],requires:a=>a.canManageResources},{id:"admin-policies",href:"/admin/policies",label:"Policies",icon:"shield",match:["/admin/policies"],requires:a=>a.canManagePolicies},{id:"admin-notifications",href:"/admin/notifications",label:"Notifications",icon:"megaphone",match:["/admin/notifications"],requires:a=>a.canManageNotifications}]},{id:"admin-website",label:"Website & marketing",icon:"globe",items:[{id:"admin-website-navigation",href:"/admin/marketing/navigation",label:"Navigation",icon:"globe",match:["/admin/marketing/navigation"],requires:a=>a.canManageWebsiteContent},{id:"admin-website-branding",href:"/admin/marketing/branding",label:"Branding",icon:"megaphone",match:["/admin/marketing/branding"],requires:a=>a.canManageWebsiteContent},{id:"admin-website-home",href:"/admin/marketing/home",label:"Home & context",icon:"home",match:["/admin/marketing/home"],requires:a=>a.canManageWebsiteContent},{id:"admin-website-supports",href:"/admin/marketing/supports",label:"Supports",icon:"lifebuoy",match:["/admin/marketing/supports"],requires:a=>a.canManageWebsiteContent},{id:"admin-website-programs",href:"/admin/marketing/programs",label:"Programs",icon:"briefcase",match:["/admin/marketing/programs"],requires:a=>a.canManageWebsiteContent},{id:"admin-website-footer",href:"/admin/marketing/footer",label:"Footer",icon:"settings",match:["/admin/marketing/footer"],requires:a=>a.canManageWebsiteContent},{id:"admin-public-resources",href:"/admin/website",label:"Public resources",icon:"book",match:["/admin/website"],requires:a=>a.canManageWebsiteContent},{id:"admin-content-inventory",href:"/admin/content-inventory",label:"Content inventory",icon:"file",match:["/admin/content-inventory"],requires:a=>a.canManageWebsiteContent}]},{id:"admin-inventory",label:"Inventory & donations",icon:"boxes",items:[{id:"admin-inventory-overview",href:"/admin/inventory/overview",label:"Inventory overview",icon:"boxes",match:["/admin/inventory/overview"],requires:a=>a.canAccessInventoryWorkspace},{id:"admin-inventory-items",href:"/admin/inventory/items",label:"Items & stock levels",icon:"box",match:["/admin/inventory/items"],requires:a=>a.canAccessInventoryWorkspace},{id:"admin-inventory-donations-map",href:"/admin/inventory/donations-mapping",label:"Donations mapping",icon:"route",match:["/admin/inventory/donations-mapping"],requires:a=>a.canAccessInventoryWorkspace},{id:"admin-donations",href:"/admin/donations",label:"Donations catalogue",icon:"briefcase",match:["/admin/donations"],requires:a=>a.iharcRoles.includes("iharc_admin")}]}]},{id:"org",label:"Organization workspace",defaultRoute:"/org",groups:[{id:"org-overview",label:"Overview",icon:"dashboard",items:[{id:"org-home",href:"/org",label:"Overview",icon:"dashboard",exact:!0,requires:a=>a.canAccessOrgWorkspace}]},{id:"org-people",label:"People",icon:"users",items:[{id:"org-members",href:"/org/members",label:"Members",icon:"users",match:["/org/members"],requires:a=>a.canManageOrgUsers},{id:"org-invites",href:"/org/invites",label:"Invitations",icon:"idCard",match:["/org/invites"],requires:a=>a.canManageOrgInvites}]},{id:"org-settings",label:"Settings",icon:"settings",items:[{id:"org-settings-general",href:"/org/settings",label:"Settings",icon:"settings",match:["/org/settings"],requires:a=>a.isProfileApproved&&(a.portalRoles.includes("portal_org_admin")||a.portalRoles.includes("portal_org_rep"))},{id:"org-appointments",href:"/org/appointments",label:"Appointments",icon:"calendar",match:["/org/appointments"],requires:a=>a.canAccessOrgWorkspace}]}]}];function f(a){return e.find(b=>b.id===a)}a.s(["getWorkspaceNavBlueprint",()=>f],4985);let g=["client","admin","staff","org"];async function h(a){let{data:{user:d},error:e}=await a.auth.getUser();if(e||!d)return null;let f=await (0,b.ensurePortalProfile)(a,d.id),g=await i(a,d.id),h=g.filter(a=>a.startsWith("iharc_")),j=g.filter(a=>a.startsWith("portal_")),k=(await (0,c.getInventoryRoles)(a)).filter(a=>a.startsWith("iharc_")),l=f.organization_id??null,m="approved"===f.affiliation_status,n=j.includes("portal_admin"),o=h.includes("iharc_admin"),p=j.includes("portal_org_admin"),q=j.includes("portal_org_rep"),r=m&&h.some(a=>k.includes(a)),s=m&&h.some(a=>["iharc_admin","iharc_supervisor","iharc_staff","iharc_volunteer"].includes(a));return{userId:d.id,email:d.email??null,profile:f,isProfileApproved:m,iharcRoles:h,portalRoles:j,organizationId:l,canAccessAdminWorkspace:m&&(n||o||p),canAccessOrgWorkspace:m&&(p||q)&&null!==l,canManageResources:m&&n,canManagePolicies:m&&n,canAccessInventoryWorkspace:r,canManageNotifications:m&&n,canManageWebsiteContent:m&&n,canReviewProfiles:m&&(n||o),canViewMetrics:m&&n,canManageSiteFooter:m&&n,canManageConsents:m&&(n||o),canManageOrgUsers:m&&p&&null!==l,canManageOrgInvites:m&&p&&null!==l,canAccessStaffWorkspace:s,inventoryAllowedRoles:k}}async function i(a,b){let{data:c,error:d}=await a.rpc("get_user_roles",{user_uuid:b});if(d)throw Error("Unable to load your roles right now. Please try again or contact support.");return Array.isArray(c)?c.map(a=>"string"==typeof a?a:a&&"object"==typeof a&&"role_name"in a&&"string"==typeof a.role_name?a.role_name:null).filter(a=>!!a):[]}function j(a,b){return!a.requires||!!a.requires(b)}function k(a,b){if(!a||"client"!==b&&("admin"===b?!a.canAccessAdminWorkspace:"org"===b?!a.canAccessOrgWorkspace:"staff"!==b||!a.canAccessStaffWorkspace))return null;let c=f(b);if(!c)return null;let d=c.groups.map(b=>{let c=b.items.filter(b=>j(b,a)).map(({href:a,label:b,exact:c,icon:d,match:e})=>({href:a,label:b,exact:c,icon:d,match:e}));return 0===c.length?null:{id:b.id,label:b.label,icon:b.icon,items:c}}).filter(Boolean);return 0===d.length?null:{id:c.id,label:c.label,defaultRoute:c.defaultRoute,groups:d}}function l(a,b){return k(a,b)}(()=>{let a=f("client");if(a)return a.groups.flatMap(a=>a.items.filter(a=>!a.requires).map(({href:a,label:b,exact:c,icon:d,match:e})=>({href:a,label:b,exact:c,icon:d,match:e})))})();let m=[{href:"/profile",label:"Profile"},{href:"/support",label:"Support"},{href:"/admin",label:"Admin workspace",requires:a=>a.canAccessAdminWorkspace},{href:"/org",label:"Organization workspace",requires:a=>a.canAccessOrgWorkspace},{href:"/staff",label:"Staff workspace",requires:a=>a.canAccessStaffWorkspace}];function n(a){let b=new Set;return a.filter(a=>!b.has(a.href)&&(b.add(a.href),!0))}function o(a){return n(m.filter(b=>j(b,a)).map(({href:a,label:b})=>({href:a,label:b})))}function p(a,b=[]){return a?n([...b,...g.map(b=>k(a,b)).filter(a=>!!a).flatMap(a=>a.groups.flatMap(b=>b.items.map(c=>({...c,group:b.label||a.label}))))]).slice(0,20):[]}a.s(["buildCommandPaletteItems",()=>p,"buildUserMenuLinks",()=>o,"loadPortalAccess",()=>h,"resolveWorkspaceNavForShell",()=>l],65108)}];

//# sourceMappingURL=src_lib_577ba44b._.js.map