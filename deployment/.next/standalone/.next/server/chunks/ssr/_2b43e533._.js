module.exports=[37936,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"registerServerReference",{enumerable:!0,get:function(){return d.registerServerReference}});let d=a.r(11857)},16349,a=>{"use strict";var b=a.i(5246);a.i(42537);var c=a.i(5860),d=a.i(31507);async function e(){let{url:a,anonKey:e}=(0,d.getSupabaseEnv)(),f=await (0,b.cookies)();return(0,c.createServerClient)(a,e,{cookies:{getAll:()=>f.getAll(),setAll(a){a.forEach(({name:a,value:b,options:c})=>{try{f.set(a,b,{path:"/",sameSite:"lax",httpOnly:!0,secure:!0,...c})}catch(a){}})}}})}a.s(["createSupabaseServerClient",()=>e])},6687,a=>{"use strict";function b(a){if("string"!=typeof a)return;let b=a.trim();if(!b)return;let c=b.startsWith("+"),d=b.replace(/\D+/g,"");if(d){if(c)return`+${d}`;if(10===d.length)return`+1${d}`;if(d.length>10)return`+${d}`}}function c(a){let c=b(a);if(!c)return"";let d=c.slice(-4),e=c.slice(0,Math.max(2,c.length-4)).replace(/\d/g,"*");return`${e}${d}`}a.s(["maskPhoneNumber",()=>c,"normalizePhoneNumber",()=>b])},28725,a=>{"use strict";function b(a){if("string"!=typeof a)return;let b=a.trim();return b.length>0?b.toLowerCase():void 0}a.s(["normalizeEmail",()=>b])},878,a=>{"use strict";let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call ResetPasswordForm() from the server but ResetPasswordForm is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/auth/reset-password-form.tsx <module evaluation>","ResetPasswordForm");a.s(["ResetPasswordForm",0,b])},29216,a=>{"use strict";let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call ResetPasswordForm() from the server but ResetPasswordForm is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/auth/reset-password-form.tsx","ResetPasswordForm");a.s(["ResetPasswordForm",0,b])},48023,a=>{"use strict";a.i(878);var b=a.i(29216);a.n(b)},6467,a=>{"use strict";var b=a.i(7997),c=a.i(37936),d=a.i(48023),e=a.i(16349),f=a.i(28725),g=a.i(6687);let h={status:"idle",contactMethod:"email"},i=async function(a,b){var c;if("email"==("string"==typeof(c=b.get("contact_method"))&&"phone"===c.trim().toLowerCase()?"phone":"email")){let a=(0,f.normalizeEmail)(b.get("email"));if(!a)return{status:"idle",contactMethod:"email",error:"Enter the email linked to your account."};try{let b=await (0,e.createSupabaseServerClient)(),{error:c}=await b.auth.resetPasswordForEmail(a,{redirectTo:"https://stevi.iharc.ca/reset-password/update"});if(c)throw c;return{status:"success",contactMethod:"email",message:"Check your inbox for a secure link to finish updating your password."}}catch(a){if(a instanceof Error)return{status:"idle",contactMethod:"email",error:a.message};return{status:"idle",contactMethod:"email",error:"We could not send that reset link. Try again shortly."}}}let d=b.get("intent")??"",h=b.get("stage")??"request";if("cancel"===d)return{status:"idle",contactMethod:"phone"};if("verify"===h){let a=b.get("otp_phone")??b.get("phone")??"",c=(0,g.normalizePhoneNumber)(a),d=b.get("otp_code")?.trim(),f=b.get("new_password")??"",h=b.get("confirm_password")??"";if(!c)return{status:"otp_sent",contactMethod:"phone",error:"Enter the phone number we texted the code to."};if(!d||d.length<4)return{status:"otp_sent",contactMethod:"phone",phone:c,maskedPhone:(0,g.maskPhoneNumber)(c)??c,error:"Enter the 6-digit verification code from your text message."};if(f.length<8)return{status:"otp_sent",contactMethod:"phone",phone:c,maskedPhone:(0,g.maskPhoneNumber)(c)??c,error:"New password must be at least 8 characters."};if(f!==h)return{status:"otp_sent",contactMethod:"phone",phone:c,maskedPhone:(0,g.maskPhoneNumber)(c)??c,error:"New passwords do not match."};try{let a=await (0,e.createSupabaseServerClient)(),{error:b}=await a.auth.verifyOtp({phone:c,token:d,type:"sms"});if(b)throw b;let{error:g}=await a.auth.updateUser({password:f});if(g)throw g;return await a.auth.signOut(),{status:"success",contactMethod:"phone",message:"Password updated. Sign in with your new password."}}catch(b){let a=(0,g.maskPhoneNumber)(c)??c;if(b instanceof Error)return{status:"otp_sent",contactMethod:"phone",phone:c,maskedPhone:a,error:b.message};return{status:"otp_sent",contactMethod:"phone",phone:c,maskedPhone:a,error:"We could not verify that code. Try again."}}}let i=b.get("phone")??"",j=(0,g.normalizePhoneNumber)(i);if(!j)return{status:"idle",contactMethod:"phone",error:"Enter the phone number linked to your account, including country code."};try{let a=await (0,e.createSupabaseServerClient)(),{error:b}=await a.auth.signInWithOtp({phone:j,options:{shouldCreateUser:!1}});if(b)throw b;return{status:"otp_sent",contactMethod:"phone",phone:j,maskedPhone:(0,g.maskPhoneNumber)(j)??j,message:"We sent a 6-digit verification code to your phone."}}catch(a){if(a instanceof Error)return{status:"idle",contactMethod:"phone",error:a.message};return{status:"idle",contactMethod:"phone",error:"We could not send a verification code. Try again shortly."}}};async function j(){return(0,b.jsx)(d.ResetPasswordForm,{action:i,initialState:h})}(0,c.registerServerReference)(i,"602eed74800a17d40aeffc3329c6142fa9676a3e77",null),a.s(["$$RSC_SERVER_ACTION_0",0,i,"default",()=>j,"dynamic",0,"force-dynamic"])},48319,a=>{"use strict";var b=a.i(6467);a.s([],23728),a.i(23728),a.s(["602eed74800a17d40aeffc3329c6142fa9676a3e77",()=>b.$$RSC_SERVER_ACTION_0],48319)}];

//# sourceMappingURL=_2b43e533._.js.map